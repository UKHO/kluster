import pytest

from HSTB.kluster.modules.orientation import *
from HSTB.kluster.modules.beampointingvector import *
from HSTB.kluster.modules.svcorrect import *
from HSTB.kluster.modules.georeference import *
from HSTB.kluster.modules.tpu import *

from HSTB.kluster.xarray_conversion import build_tpu_parameters


try:
    from hstb_kluster.tests.test_fqpr_generation import load_dataset
except ImportError:
    # relative import as tests directory can vary in location depending on how kluster is installed
    from .test_fqpr_generation import load_dataset

try:
    from hstb_kluster.tests.test_datasets import RealFqpr
except ImportError:
    from .test_datasets import RealFqpr


# tx vector is a 3d vector representing the transmitter orientation for each beam
tx_vector = np.array([0.6136555921172974, -0.7895255928982701, 0.008726535498373935])
beamwise_tx_vector = np.repeat(tx_vector[:, np.newaxis], 400, axis=1).T
expected_tx_vector = np.array([beamwise_tx_vector])

# rx vector is a 3d vector representing the receiver orientation for each beam
expected_rx_vector = np.array([[[0.7834063072490661, 0.6195440454987808, -0.04939365798750035],
                                [0.7834435890983565, 0.6195193360620657, -0.049111454324861144],
                                [0.7834807739129912, 0.6194945991107195, -0.04882948475408347],
                                [0.7835178722855959, 0.6194698277952879, -0.048547669978373974],
                                [0.7835548739045037, 0.619445029198466, -0.04826608935690515],
                                [0.7835917789285117, 0.6194202034502759, -0.047984742921781294],
                                [0.7836285875163148, 0.6193953506806034, -0.04770363070498524],
                                [0.7836653050065387, 0.6193704675022284, -0.047422713071688716],
                                [0.7837019263592834, 0.6193455575482035, -0.04714202971927511],
                                [0.7837384517329713, 0.6193206209480154, -0.04686158067937501],
                                [0.7837748761334387, 0.6192956613682354, -0.04658140565174841],
                                [0.7838112100330448, 0.619270671870369, -0.046301425331797985],
                                [0.783847453562414, 0.619245652563269, -0.046021639749254675],
                                [0.7838835966020993, 0.6192206106705311, -0.04574212827330686],
                                [0.7839196342216207, 0.6191955499052648, -0.04546293060678226],
                                [0.7839555768470762, 0.6191704632946942, -0.04518396744202581],
                                [0.7839914297337468, 0.619145347389742, -0.0449051991385342],
                                [0.7840271777464278, 0.6191202130514012, -0.044626744740780454],
                                [0.7840628261766726, 0.6190950568570898, -0.04434856460998277],
                                [0.7840983752091633, 0.619069878954891, -0.04407065877799847],
                                [0.7841713228311169, 0.619017923877305, -0.04349880881044178],
                                [0.7842170714917681, 0.6189851405173199, -0.04313908436242855],
                                [0.7842815136627628, 0.6189386974012546, -0.042630929922814476],
                                [0.7842881580482362, 0.618933891161549, -0.042578439578370084],
                                [0.7843178917359397, 0.6189123425236944, -0.04234332266986034],
                                [0.7843674880619574, 0.6188762504171628, -0.04195033183382973],
                                [0.7843753926353613, 0.6188704808790774, -0.04188760347193721],
                                [0.7843983728992749, 0.6188536805761973, -0.0417050911791818],
                                [0.7844287992832196, 0.6188313744988821, -0.04146310155922413],
                                [0.7844627005479473, 0.6188064372092074, -0.041193017824247585],
                                [0.78448311575389, 0.6187913773145142, -0.041030140851275494],
                                [0.784515426821354, 0.6187674760862928, -0.040771995500682945],
                                [0.7845250955126059, 0.6187603081626413, -0.04069466246831172],
                                [0.7845852039421556, 0.6187155826587307, -0.040213002005738255],
                                [0.7845964526099097, 0.6187071812492536, -0.040122692114923],
                                [0.7846267548118888, 0.618684499456242, -0.03987913948348757],
                                [0.7846815617524154, 0.6186432904163852, -0.03943761996594428],
                                [0.7846902160088957, 0.6186367614405507, -0.03936778244021043],
                                [0.7847345646143077, 0.6186032095827797, -0.03900938596641301],
                                [0.7847745597811259, 0.6185728154171182, -0.0386854280999978],
                                [0.7847932244678001, 0.6185585869116675, -0.038534003000911955],
                                [0.7848124122704299, 0.6185439300770607, -0.03837817232611734],
                                [0.7848583917506012, 0.618508685647327, -0.03800408764167062],
                                [0.7848845998598397, 0.6184885187711958, -0.03779043597355389],
                                [0.7849254088991371, 0.6184570036075956, -0.03745713754729724],
                                [0.7849714470036253, 0.618421283992165, -0.037080222417302966],
                                [0.7850076788072177, 0.6183930480056689, -0.036782908965478735],
                                [0.7850338446752483, 0.6183725877878791, -0.03656781900688124],
                                [0.7851349452562169, 0.6182929860076338, -0.03573375422875687],
                                [0.7851548547836391, 0.6182772069430371, -0.03556893847726324],
                                [0.7851841627056443, 0.6182539169463462, -0.035325979345753995],
                                [0.7852113491329015, 0.6182322461592824, -0.035100242189149256],
                                [0.7852332138545626, 0.6182147706367064, -0.03491843676682872],
                                [0.7852647859979847, 0.6181894624938131, -0.034655509419858954],
                                [0.7852859608042138, 0.6181724396954321, -0.03447890028408778],
                                [0.7853128986635332, 0.6181507266036383, -0.034253910609936475],
                                [0.7853426292948932, 0.6181266876287075, -0.03400518568315871],
                                [0.7853857509955716, 0.6180916809256751, -0.033643663647044915],
                                [0.7854127408989205, 0.6180696852310377, -0.03341692134310315],
                                [0.7854425488280098, 0.6180453164891394, -0.03316608593728169],
                                [0.7854733394915706, 0.6180200596288339, -0.03290651674566087],
                                [0.7854998433796017, 0.6179982498181505, -0.032682706012874985],
                                [0.7855368059851396, 0.6179677259824533, -0.032369987438068175],
                                [0.7855561579645751, 0.6179516948067395, -0.03220598654619529],
                                [0.7855756419391888, 0.6179355192390134, -0.03204067500291415],
                                [0.7856122655416695, 0.6179050187734639, -0.03172941860561749],
                                [0.7856441719870131, 0.6178783445330314, -0.03145769190453953],
                                [0.7856715646231337, 0.6178553674918539, -0.031223987640003243],
                                [0.7856999978798572, 0.6178314425131899, -0.03098099374880461],
                                [0.785726927531514, 0.6178087118782768, -0.03075046144680697],
                                [0.7857502975386058, 0.6177889297165978, -0.030550093905141615],
                                [0.7857777175309214, 0.6177656525211289, -0.03031463667998268],
                                [0.7858109553811085, 0.617737339243096, -0.030028688081395964],
                                [0.7858406016796147, 0.6177119949862453, -0.029773142291905325],
                                [0.785867282053582, 0.6176891129875087, -0.029542760440090056],
                                [0.7858947896299338, 0.6176654484978318, -0.029304835172622914],
                                [0.7859231199396162, 0.6176409982926265, -0.02905936634662302],
                                [0.7859511443934891, 0.617616733848941, -0.028816118689566524],
                                [0.785981267924202, 0.6175905647539796, -0.02855417305972098],
                                [0.786006399474676, 0.6175686628271161, -0.028335255050624817],
                                [0.7860323913686508, 0.6175459442789368, -0.028108476015544243],
                                [0.7860610543178242, 0.6175208118643192, -0.02785795755583602],
                                [0.7860929124057027, 0.6174927798628607, -0.027578975375399148],
                                [0.7861253611763545, 0.617464121422952, -0.02729423511894237],
                                [0.7861503450443674, 0.6174419821262334, -0.027074595004358153],
                                [0.7861753924748539, 0.6174197217223465, -0.02685404057697548],
                                [0.786200943686945, 0.6173969464338326, -0.0266286815283127],
                                [0.7862232467664708, 0.6173770106931291, -0.026431664941977226],
                                [0.7862536765730035, 0.6173497266574377, -0.02616239804417298],
                                [0.7862842519323755, 0.6173222137447358, -0.02589130318163774],
                                [0.7863102392236074, 0.6172987513955012, -0.025660460199856728],
                                [0.7863371807331324, 0.6172743514959058, -0.025420723474717116],
                                [0.7863638965367219, 0.6172500791641741, -0.02518257324827561],
                                [0.7863901521632778, 0.6172261499716513, -0.02494811359180442],
                                [0.7864122867437384, 0.6172059186638527, -0.024750135854045372],
                                [0.7864346279139718, 0.6171854444648334, -0.024550013412599023],
                                [0.7864611184367224, 0.6171610969417491, -0.024312334501581125],
                                [0.7864886122675889, 0.6171357457199539, -0.024065205756004633],
                                [0.7865151171817271, 0.6171112272808572, -0.023826531609291282],
                                [0.7865378721464648, 0.6170901154986383, -0.02362128347886247],
                                [0.786560640411069, 0.6170689335414248, -0.023415597668598218],
                                [0.7865844432733793, 0.6170467269228661, -0.023200224009389585],
                                [0.7866100064112101, 0.6170228069804199, -0.022968532381486318],
                                [0.7866350181489765, 0.6169993313683508, -0.022741444825855744],
                                [0.7866614829242481, 0.6169744144139317, -0.02250073869918165],
                                [0.7866837200103913, 0.6169534159302735, -0.02229814437524491],
                                [0.7867044055795314, 0.6169338315060555, -0.02210940489959728],
                                [0.7867264595437111, 0.6169128971040304, -0.021907880785904152],
                                [0.7867497844538989, 0.6168906948779408, -0.021694405609627487],
                                [0.7867736556546426, 0.6168679069890924, -0.021475569718317714],
                                [0.7867954565247652, 0.6168470371617482, -0.02127539275217121],
                                [0.7868246507396794, 0.6168190020853886, -0.021006847806530667],
                                [0.7868427482518093, 0.6168015724910824, -0.020840098273952376],
                                [0.7868624310009629, 0.6167825719651013, -0.02065849944621884],
                                [0.7868821636190413, 0.6167634768804391, -0.02047618530313593],
                                [0.7869058559985729, 0.6167404882910602, -0.020256946898736475],
                                [0.7869250867872393, 0.616721779054418, -0.020078720697534327],
                                [0.786944740037952, 0.6167026125907058, -0.01989632504755968],
                                [0.786967652348219, 0.616680208539778, -0.019683357256033016],
                                [0.7869923036279147, 0.6166560325178352, -0.019453832264897088],
                                [0.7870135339286046, 0.6166351517623019, -0.01925583091668552],
                                [0.7870329391261273, 0.6166160174561343, -0.019074583796929386],
                                [0.7870526605785649, 0.6165965235391765, -0.01889012005266348],
                                [0.7870720190942715, 0.616577341336654, -0.018708792293737134],
                                [0.7870911260682772, 0.616558362497024, -0.018529568250760107],
                                [0.787108626464985, 0.6165409392977931, -0.01836519300741563],
                                [0.7871250748999642, 0.6165245282763494, -0.01821050513716082],
                                [0.7871427591963984, 0.6165068460715067, -0.018043984915869206],
                                [0.787164127430735, 0.616485427430439, -0.01784248447157637],
                                [0.7871815506344115, 0.6164679200743365, -0.017677948411085206],
                                [0.7871989009475415, 0.6164504473695867, -0.017513888340948778],
                                [0.7872168113739174, 0.6164323700469114, -0.017344308825361622],
                                [0.7872344132710082, 0.6164145638309066, -0.017177428765810784],
                                [0.7872506251632384, 0.6163981282777878, -0.01702353182303376],
                                [0.7872661117421961, 0.6163823961574527, -0.016876344672977266],
                                [0.7872808921562211, 0.6163673522382175, -0.016735708546513413],
                                [0.7872956394379651, 0.6163523135615807, -0.016595230918924363],
                                [0.7873118849090103, 0.616335714048402, -0.016440300163551518],
                                [0.7873280646790778, 0.6163191471134255, -0.016285805785334735],
                                [0.7873417298292318, 0.6163051280148328, -0.016155174159805448],
                                [0.7873558535245012, 0.6162906124664508, -0.01602001580620944],
                                [0.7873710307122109, 0.6162749846096527, -0.015874613052376894],
                                [0.7873854993448183, 0.6162600577140334, -0.015735840867508906],
                                [0.7873988773326965, 0.6162462310565996, -0.015607391958462878],
                                [0.7874099415110216, 0.6162347776426935, -0.015501059101547929],
                                [0.787422502258717, 0.6162217550197194, -0.01538023332195379],
                                [0.7874345356157205, 0.6162092591885514, -0.015264370604494176],
                                [0.7874443379494407, 0.6161990656278098, -0.01516990938606088],
                                [0.7874560629556441, 0.6161868555175648, -0.015056825753546367],
                                [0.7874694710589274, 0.6161728697293044, -0.014927382882710087],
                                [0.7874779775473485, 0.6161639840146746, -0.014845190504046079],
                                [0.7874876730046692, 0.6161538442487805, -0.014751443425674976],
                                [0.7874986736653244, 0.6161423238506049, -0.014644990110307088],
                                [0.7875123897039709, 0.6161279364679667, -0.014512131699588272],
                                [0.787518099696827, 0.6161219393475383, -0.014456780572690356],
                                [0.7875254894026953, 0.6161141713621662, -0.01438510993202836],
                                [0.7875332961391224, 0.6161059567894217, -0.01430934942059322],
                                [0.7875422630684604, 0.6160965109861414, -0.014222272382122312],
                                [0.7875472569471403, 0.6160912455704984, -0.014173750612548948],
                                [0.7875505946407757, 0.6160877244594721, -0.014141310098784441],
                                [0.7875606555198235, 0.6160771013140178, -0.014043472280863802],
                                [0.787569268702693, 0.6160679955507615, -0.013959650897232953],
                                [0.7875733223376994, 0.6160637065035262, -0.013920182150222057],
                                [0.7875769589009136, 0.6160598567923317, -0.013884763498179686],
                                [0.7875805944186666, 0.6160560063362263, -0.01384934482924801],
                                [0.7875841270421715, 0.6160522630826226, -0.013814918819871465],
                                [0.7875873980142858, 0.6160487955199146, -0.013783034047315927],
                                [0.7875898048759049, 0.616046243042681, -0.013759567163692109],
                                [0.7875956307565601, 0.6160400613246844, -0.013702746303403025],
                                [0.7875965750204141, 0.6160390589368494, -0.013693534252128214],
                                [0.7875982476590401, 0.6160372830312604, -0.013677214624045081],
                                [0.7875984592665998, 0.6160370583312071, -0.01367514985333034],
                                [0.7875992527633046, 0.6160362156834626, -0.013667406962646912],
                                [0.7875993544900376, 0.6160361076491264, -0.013666414284296725],
                                [0.7875988824710604, 0.6160366089235063, -0.01367102031173136],
                                [0.7875988946786703, 0.6160365959596726, -0.013670901190335726],
                                [0.7875970349164183, 0.6160385706865976, -0.013689047347435583],
                                [0.7875951830205337, 0.6160405365771697, -0.01370711408594123],
                                [0.787593509975237, 0.6160423121930513, -0.013723433707545259],
                                [0.7875905541266123, 0.6160454482960508, -0.013752261059676434],
                                [0.7875874550349273, 0.6160487350589222, -0.013782478148296504],
                                [0.7875804884654519, 0.6160561185797927, -0.013850377212213277],
                                [0.7875809489479609, 0.6160556307473875, -0.013845890316914031],
                                [0.7875805129162732, 0.6160560926774866, -0.013850138969991793],
                                [0.787572812646109, 0.6160642459214821, -0.013925145524997311],
                                [0.7875703209781783, 0.6160668823859432, -0.01394940649610935],
                                [0.7875522611166139, 0.6160859658248645, -0.014125109689929801],
                                [0.7875471221136713, 0.6160913877809446, -0.014175060938994432],
                                [0.7875431704492087, 0.6160955545252105, -0.014213457464038992],
                                [0.7875400515676418, 0.6160988416278458, -0.014243753777103184],
                                [0.7875325148625837, 0.6161067792613196, -0.01431693341668795],
                                [0.7875241960014834, 0.6161155315178833, -0.014397657262675235],
                                [0.7875171331917477, 0.6161229547699334, -0.01446615135473473],
                                [0.7875030286455514, 0.6161377585190155, -0.014602821687849158],
                                [0.7874930698833656, 0.6161481944658196, -0.014699229305756914],
                                [0.7874844502111048, 0.6161572161608152, -0.01478261305278985],
                                [0.7874757590060225, 0.6161663024141776, -0.01486663200355052],
                                [0.7874648497190546, 0.6161776929478071, -0.014972012906235949],
                                [0.7874552111109048, 0.616187743236034, -0.01506504497052197],
                                [0.7874434647350449, 0.6161999742225577, -0.015178327120842995],
                                [0.7874316994231846, 0.6162122061485893, -0.015291688494204758],
                                [0.7874188133104337, 0.616225581823615, -0.015415730632552836],
                                [0.7874119401559967, 0.6162327069284231, -0.015481841345172937],
                                [0.7873933747920168, 0.6162519210482464, -0.01566024067453681],
                                [0.7873808562271374, 0.616264850943807, -0.015780390940253203],
                                [0.7873656200050335, 0.6162805595037775, -0.01592646890556971],
                                [0.7873522120296986, 0.6162943575282319, -0.01605487747708363],
                                [0.7873375694860462, 0.6163093987360101, -0.01619495926092996],
                                [0.7873246399359126, 0.6163226566905513, -0.016318523207887528],
                                [0.7873113939243988, 0.616336216242012, -0.016444985415016482],
                                [0.7872944395952399, 0.6163535381776694, -0.01660666607978249],
                                [0.7872782852898955, 0.6163700076526248, -0.01676052437440762],
                                [0.7872609209231145, 0.6163876727559061, -0.016925698267647067],
                                [0.7872460137243776, 0.6164028068060999, -0.01706732658147567],
                                [0.7872296329414711, 0.6164194036098081, -0.017222771907133838],
                                [0.787211571980392, 0.6164376625357553, -0.017393939968108382],
                                [0.787194116313138, 0.6164552696096857, -0.01755915181401805],
                                [0.787175658530352, 0.6164738449750593, -0.017733614379847256],
                                [0.7871593556676669, 0.6164902154861642, -0.017887509460134624],
                                [0.7871446510688858, 0.6165049520768614, -0.018026157614670656],
                                [0.7871248132994909, 0.6165247895489465, -0.018212966805792274],
                                [0.7871059098831746, 0.6165436464202921, -0.018390722817485015],
                                [0.7870877756040746, 0.6165616937970301, -0.018561013893832815],
                                [0.787068863069505, 0.616580471804534, -0.01873837174823637],
                                [0.787048430874985, 0.6166007085095799, -0.018929704770756246],
                                [0.7870256350979771, 0.6166232249832179, -0.019142834427581308],
                                [0.7870073644551631, 0.6166412253754906, -0.01931340106639657],
                                [0.7869881064988306, 0.6166601539865723, -0.01949294012308828],
                                [0.7869698245802169, 0.6166780811729807, -0.019663148298102166],
                                [0.78695063830861, 0.6166968512681338, -0.019841534760212512],
                                [0.7869297480597863, 0.6167172374698953, -0.020035484173382464],
                                [0.7869096408407721, 0.6167368096234843, -0.02022188931067497],
                                [0.7868883115161912, 0.6167575180866866, -0.020419331104334186],
                                [0.7868677579212968, 0.6167774217380747, -0.02060930804380467],
                                [0.7868490295714541, 0.6167955139002099, -0.020782172529282585],
                                [0.7868276298004594, 0.6168161356421683, -0.020979413577447866],
                                [0.7868042202220996, 0.616838631985481, -0.021194837366074536],
                                [0.7867840024663544, 0.6168580090128577, -0.02138060288479144],
                                [0.7867627990217219, 0.6168782791875759, -0.02157514176270633],
                                [0.7867389053672619, 0.6169010582007436, -0.02179401689284096],
                                [0.7867147459495001, 0.6169240230703688, -0.022014955468601154],
                                [0.7866923041559661, 0.6169452947244592, -0.022219853715242436],
                                [0.7866685155006887, 0.6169677796823203, -0.0224367010456241],
                                [0.7866418015253716, 0.6169929523409345, -0.022679789561089656],
                                [0.786620750967169, 0.617012731015632, -0.02287102779672692],
                                [0.7866009181246691, 0.6170313195313276, -0.02305095058465549],
                                [0.786576777914965, 0.6170538851878048, -0.023269620098900507],
                                [0.7865535425591222, 0.6170755430953183, -0.023479753007922006],
                                [0.7865316257201224, 0.6170959166005328, -0.023677657337867863],
                                [0.7865076448726409, 0.6171181474408532, -0.023893862309404736],
                                [0.7864824112660674, 0.6171414707523651, -0.024120983535501926],
                                [0.7864576786932557, 0.6171642627685483, -0.0243432205299554],
                                [0.7864374353787796, 0.6171828677560273, -0.024524844205292898],
                                [0.786414539652392, 0.617203856489151, -0.02472996882804213],
                                [0.786385234377182, 0.6172306376799671, -0.024992059993640733],
                                [0.7863583960162877, 0.6172550828733312, -0.0252316404882485],
                                [0.7863380766243621, 0.6172735387866713, -0.025412744135151856],
                                [0.7863150921282643, 0.6172943620324444, -0.02561730849009873],
                                [0.786279084959075, 0.6173268701397554, -0.025937154033805965],
                                [0.7862611010361131, 0.617343054920262, -0.026096619305908682],
                                [0.7862448718931065, 0.6173576311435486, -0.026240363766892164],
                                [0.7862252045542533, 0.6173752582259507, -0.026414356968575886],
                                [0.7861944349893105, 0.6174027544729508, -0.02668612300526071],
                                [0.7861647581104575, 0.617429180744912, -0.026947724760962657],
                                [0.7861359728099043, 0.6174547258552131, -0.02720098846162005],
                                [0.7861113865536706, 0.6174764769172424, -0.02741693608949448],
                                [0.7860853571684722, 0.6174994370973177, -0.027645188185492595],
                                [0.7860629826875536, 0.6175191180269861, -0.02784108689545166],
                                [0.7860440971925228, 0.6175356903687355, -0.028006220551895878],
                                [0.7860192210453268, 0.6175574644831794, -0.028223433674946518],
                                [0.7859898212150309, 0.6175831177492213, -0.028479705362158356],
                                [0.78596518386468, 0.6176045486666626, -0.02869409728163036],
                                [0.7859397630928178, 0.6176265975390033, -0.028914958101290928],
                                [0.785910459023963, 0.6176519349748747, -0.029169120976419896],
                                [0.7858850200434045, 0.6176738616907675, -0.02938938337890526],
                                [0.7858647188992698, 0.617691314260089, -0.02956490955534324],
                                [0.7858452753025613, 0.6177079917532089, -0.029732813672091817],
                                [0.7858170658972399, 0.6177321224283886, -0.029976054856690887],
                                [0.7857922270576609, 0.6177533058865466, -0.030189881781884236],
                                [0.7857645587135287, 0.6177768322399928, -0.03042768175943247],
                                [0.7857309761476462, 0.6178052885622757, -0.030715770323246662],
                                [0.785708960774508, 0.6178238848319048, -0.030904308596955032],
                                [0.7856890102966493, 0.6178406970324941, -0.031074944721970216],
                                [0.785651950551494, 0.6178718270392164, -0.0313913673778829],
                                [0.785628245057071, 0.6178916716128864, -0.03159339677812151],
                                [0.7856096622311922, 0.6179071909675417, -0.03175156625419171],
                                [0.7855920161963897, 0.6179218980696503, -0.03190159830623355],
                                [0.7855574029962987, 0.6179506622362512, -0.032195428860158526],
                                [0.7855310082329956, 0.617972522103371, -0.03241908434321279],
                                [0.7855097076852383, 0.617990116135181, -0.032599317346793215],
                                [0.7854855320167621, 0.618010034492046, -0.03280360131882301],
                                [0.7854575368242083, 0.6180330329677179, -0.03303979429069239],
                                [0.7854322445772891, 0.6180537495786487, -0.033252846645882454],
                                [0.7854061449914289, 0.6180750666953596, -0.033472366800532095],
                                [0.7853789885876543, 0.6180971817472968, -0.03370041841108775],
                                [0.7853526181243915, 0.6181185933895452, -0.03392152283276363],
                                [0.7853255666568276, 0.6181404933980167, -0.03414798349520958],
                                [0.7852974604959561, 0.6181631783015039, -0.03438289590458478],
                                [0.785270060701967, 0.6181852257638222, -0.03461153582927253],
                                [0.7852405913711443, 0.6182088646714167, -0.03485704096410686],
                                [0.7852107855673951, 0.61823269604077, -0.03510492522132999],
                                [0.7851807662197915, 0.6182566198303328, -0.03535415667884635],
                                [0.7851635488512535, 0.6182703058252099, -0.035496908176724226],
                                [0.7851353289895283, 0.6182926822072011, -0.035730579361803065],
                                [0.7851246292977213, 0.6183011483696134, -0.035819078644391954],
                                [0.7850985006060988, 0.6183217814534926, -0.03603496810370394],
                                [0.7850865136643955, 0.6183312276352475, -0.036133903655329765],
                                [0.7850771848856742, 0.6183385705875388, -0.03621085328660546],
                                [0.7850534150341615, 0.6183572470114717, -0.0364067385465177],
                                [0.7850363626875226, 0.618370615792746, -0.036547103612243836],
                                [0.7850320114160981, 0.618374023177198, -0.036582899169443],
                                [0.7850008413780831, 0.6183983849658896, -0.03683906224757948],
                                [0.7849812327358889, 0.6184136686926981, -0.036999981438941766],
                                [0.7849599993614095, 0.6184301824163155, -0.03717403501180156],
                                [0.7849423196734503, 0.618443903580757, -0.03731880101850064],
                                [0.7849259427570403, 0.6184565904153482, -0.03745277237794314],
                                [0.7849004310138704, 0.6184763093925354, -0.037661228265012364],
                                [0.784879812788137, 0.618492206601667, -0.03782948388043085],
                                [0.7848503621056093, 0.6185148530640708, -0.03806948439137032],
                                [0.7848373210168758, 0.618524858395283, -0.03817563471834595],
                                [0.7848232749774328, 0.6185356191528517, -0.03828987977123305],
                                [0.7848031067160269, 0.6185510419838288, -0.038453766390199415],
                                [0.7847741829661782, 0.6185731023802462, -0.03868848357644475],
                                [0.7847349520486296, 0.618602915773304, -0.039006251165696344],
                                [0.78472982646893, 0.6186068017605755, -0.03904771780264374],
                                [0.784715639106454, 0.6186175469630881, -0.03916243520417119],
                                [0.7846862385021389, 0.6186397629094444, -0.03939988391747559],
                                [0.7846698967152247, 0.6186520813284944, -0.03953170192188003],
                                [0.7846614250156349, 0.6186584588992565, -0.03959999147512633],
                                [0.7846201683308043, 0.6186894357404704, -0.039932111785864206],
                                [0.7846343005097984, 0.6186788400570025, -0.039818429517264047],
                                [0.7845924748316556, 0.6187101533128001, -0.04015463391925685],
                                [0.7845759023922514, 0.6187225222833251, -0.040287638361468536],
                                [0.7845668535660163, 0.6187292668349492, -0.040360211191311945],
                                [0.7845592262160244, 0.6187349468980753, -0.040421356315062405],
                                [0.7845263750406468, 0.6187593590336715, -0.04068442544539982],
                                [0.7845075254841446, 0.6187733283727773, -0.04083516319569822],
                                [0.784490768907919, 0.6187857234237211, -0.0409690369089161],
                                [0.7844621929968784, 0.6188068112094193, -0.041197064936213],
                                [0.7844372516019573, 0.6188251653675982, -0.04139580905034305],
                                [0.7844428511944309, 0.6188210488448725, -0.041351211789783696],
                                [0.7844163182983545, 0.6188405330897551, -0.0415624132172601],
                                [0.7843964406202759, 0.6188550947692705, -0.041720446070948575],
                                [0.7843749427469318, 0.6188708093796769, -0.04189117435082347],
                                [0.784355247311014, 0.6188851755527414, -0.042047419620359495],
                                [0.7843460328496235, 0.6188918866176368, -0.04212046333932723],
                                [0.7843365334883495, 0.6188987984445031, -0.042195728687027825],
                                [0.7843247040758387, 0.6189073960938769, -0.04228940336118675],
                                [0.7842910049451276, 0.6189318308340582, -0.04255594368079083],
                                [0.784259736484712, 0.6189544267972703, -0.042802841926592075],
                                [0.7842461793971043, 0.618964201000825, -0.042909765560474135],
                                [0.7842300948436567, 0.6189757796342112, -0.04303652597189567],
                                [0.7842234809736347, 0.6189805351068169, -0.04308861854914772],
                                [0.7841984458652804, 0.6189985062935215, -0.04328564090859808],
                                [0.7841789996353005, 0.6190124335124084, -0.04343850467068892],
                                [0.7841515159511301, 0.6190320694680241, -0.04365428961373161],
                                [0.7841417289723114, 0.6190390484317007, -0.04373105762600095],
                                [0.7841196031050012, 0.6190548001765043, -0.043904469076436387],
                                [0.7840852185926485, 0.6190792079620455, -0.0441735696271525],
                                [0.7840808446428285, 0.6190823066203605, -0.044207767346959],
                                [0.7840743885119067, 0.6190868778242076, -0.04425823070971631],
                                [0.7840477499921995, 0.6191057069655298, -0.0444662718797167],
                                [0.7840311921480446, 0.6191173847829287, -0.04459544369622257],
                                [0.7840147783673526, 0.6191289414490824, -0.04472338495384549],
                                [0.783998498848972, 0.6191403844070875, -0.04485017501417555],
                                [0.7839707380942255, 0.6191598536680537, -0.04506614491777348],
                                [0.783957644964771, 0.6191690170230135, -0.04516790077084917],
                                [0.7839557045148345, 0.6191703740231961, -0.045182975672535784],
                                [0.7839520222506824, 0.6191729483737755, -0.0452115782868902],
                                [0.7839244885905744, 0.6191921671087796, -0.04542528347891299],
                                [0.7839102239526928, 0.6192021027409306, -0.045535884131629095],
                                [0.783889945487753, 0.6192162022935722, -0.045692977363416445],
                                [0.7838822435551742, 0.6192215497963579, -0.04575260109221324],
                                [0.7838685029541604, 0.6192310795809752, -0.045858915789443296],
                                [0.7838366227324619, 0.6192531388560695, -0.046105302084184785],
                                [0.783830585980272, 0.6192573078980391, -0.04615191325066082],
                                [0.7838367665651067, 0.6192530394926072, -0.046104191348789604],
                                [0.7838263874539527, 0.6192602059358876, -0.04618432282851206],
                                [0.7838044351545344, 0.6192753384396763, -0.04635366902960102],
                                [0.7837843905601758, 0.6192891264901136, -0.04650813826983473],
                                [0.7837730469190339, 0.6192969170219257, -0.04659548787588627],
                                [0.7837514291960564, 0.6193117387781247, -0.04676181609769614],
                                [0.7837578349175675, 0.6193073502059717, -0.04671254848737108],
                                [0.7837364902091865, 0.6193219624602743, -0.046876654412835984],
                                [0.7837185025597084, 0.6193342520537002, -0.04701481658639264],
                                [0.7837055507976749, 0.6193430871830926, -0.04711422298445568],
                                [0.7837111128883509, 0.6193392943827648, -0.04707154096438008],
                                [0.7836806580732558, 0.6193600355046321, -0.04730510101003227],
                                [0.7836683609951719, 0.6193683923272116, -0.047399309711704266],
                                [0.7836460211471236, 0.6193835475107088, -0.04757031231063684],
                                [0.7836618807265797, 0.6193727920066795, -0.04744893273752709],
                                [0.7836234910780366, 0.6193987972335422, -0.04774258284080774],
                                [0.7836200079649865, 0.6194011517311124, -0.047769198769978774],
                                [0.7836069995254338, 0.6194099378200886, -0.04786856196358009],
                                [0.7835940920957468, 0.6194186443316916, -0.04796709170808061],
                                [0.7835812858793519, 0.6194272714151404, -0.048064788014256656],
                                [0.783568581077943, 0.6194358192184045, -0.04816165089283349],
                                [0.7835559674767817, 0.6194442948819024, -0.04825775968471177],
                                [0.783525701294591, 0.6194645884401461, -0.048488133388487245],
                                [0.7835331311926463, 0.6194596123757725, -0.048431611151239465]]])
expected_beam_azimuth = np.array([[4.697702770834351, 4.697679261997406, 4.697655690754787, 4.697632056951215, 4.6976058387438,
                                  4.697582073317882, 4.697555707317391, 4.697503783245963, 4.697477191206587, 4.697450519544917,
                                  4.697423767029866, 4.69739693829023, 4.69736743938143, 4.6972674681654984, 4.697237554683638,
                                  4.697207543294636, 4.697180075035949, 4.697147224694138, 4.6971169152263545, 4.697086503792063,
                                  4.697057787577853, 4.697028436969379, 4.696998573103777, 4.696961625748059, 4.696927348669564,
                                  4.696895389324096, 4.69685546904846, 4.696819991489281, 4.696782560854662, 4.696745425864683,
                                  4.69670645627855, 4.696638155291873, 4.696597388478074, 4.696560106752278, 4.6965192209393285,
                                  4.696474954276827, 4.696436553653597, 4.696391947186144, 4.6963201598037125, 4.696279208927468,
                                  4.696232321518216, 4.69618235595857, 4.696138728863909, 4.696089259791781, 4.6960118313801775,
                                  4.695964505544646, 4.695915593122675, 4.695865026992178, 4.695696659311642, 4.695641005512668,
                                  4.695586425755941, 4.695528120822735, 4.695471836020789, 4.695413538302367, 4.6953501646306295,
                                  4.695290477899882, 4.69522765806261, 4.695166532952184, 4.695102545209449, 4.695035330284513,
                                  4.694971141462799, 4.6948992376624075, 4.694831870703393, 4.694757852933235, 4.694683333996935,
                                  4.694611121904087, 4.694534199755169, 4.6944559667459576, 4.694377336375874, 4.694294356452168,
                                  4.694213663218283, 4.694125928113322, 4.694042110177103, 4.693953379514986, 4.69385973014668,
                                  4.693765426529692, 4.693633142863029, 4.693536973220171, 4.693436557545599, 4.693334279517286,
                                  4.693227347872663, 4.693119912628958, 4.693008123417149, 4.692851319198816, 4.69273545356964,
                                  4.692614323028098, 4.69249200661056, 4.692363512243459, 4.692235313266961, 4.692101444146268,
                                  4.691917289257069, 4.691774518793721, 4.691629958013526, 4.691483517614187, 4.691325165274448,
                                  4.691169383575102, 4.691003180571894, 4.690792006151483, 4.69061571856579, 4.690435929841206,
                                  4.690253504868634, 4.690063584880275, 4.689866078479635, 4.689665302329263, 4.68939780834661,
                                  4.689183295510179, 4.6889592078753815, 4.68872599587193, 4.688488962182566, 4.688236128959901,
                                  4.687983734364312, 4.68771677299159, 4.6873726528440365, 4.687090227666095, 4.686789006717078,
                                  4.686482573924302, 4.686161007018751, 4.685825281768076, 4.685482823659807, 4.7078558997812845,
                                  4.707728589152494, 4.70757034892126, 4.707432263199329, 4.707291354020658, 4.70714476213622,
                                  4.7069919699155145, 4.7068355729227855, 4.706669876513461, 4.706500703658051, 4.706323524636083,
                                  4.706103454920851, 4.705909124627977, 4.705705710318802, 4.70549584321329, 4.705272055427632,
                                  4.705040643147496, 4.7047973901283475, 4.704541673323727, 4.704276260420409, 4.703991231482526,
                                  4.70369440382305, 4.7033235758895735, 4.702987432986758, 4.702629599029418, 4.702252926963498,
                                  4.701845291134062, 4.70141448864763, 4.7009510856719485, 4.700452666979666, 4.699914760113605,
                                  4.699337228123052, 4.698709438139121, 4.698024240280597, 4.697273749434332, 4.696452084782136,
                                  4.6955423817745805, 4.694541352349398, 4.693256650093779, 4.691965336951472, 4.690508475692016,
                                  4.688838995664456, 4.686918699263271, 4.6846499992097606, 4.681969912802178, 4.67875318730853,
                                  4.674764172924669, 4.669749046864103, 4.66315559284505, 4.654366881646496, 4.641618665231991,
                                  4.621837145270779, 4.586348037179431, 4.507632883440956, 4.1913432780473325, 2.2027361887652237,
                                  1.7923798004098699, 1.7023817521948148, 1.664468828287377, 1.6434328559839708, 1.630046253141729,
                                  1.6207797246319717, 1.6140344149889623, 1.6088814111477678, 1.6047932521398145, 1.6014554431104773,
                                  1.5987267743440292, 1.596423957288778, 1.5944438666705836, 1.5927663451458425, 1.5912761626165126,
                                  1.5901494037494097, 1.5889755317296832, 1.5879205681715767, 1.5869725900991922, 1.5861218581565073,
                                  1.5853429582146934, 1.5846346103723072, 1.5839863688057854, 1.5833920271077973, 1.5828365906655555,
                                  1.582323329324624, 1.581847042290121, 1.5814059831560294, 1.580985399899982, 1.5805940508767213,
                                  1.5802866705044085, 1.5799343610491647, 1.5796072073145206, 1.579299099555831, 1.5790036953120583,
                                  1.5787233713125528, 1.578457880010808, 1.5782056293025346, 1.577966333082608, 1.5777382673986355,
                                  1.577517190224383, 1.5773427723620748, 1.5771434478304158, 1.5769501081921253, 1.5767623231478842,
                                  1.5765846428681238, 1.5764115806177792, 1.5762485235652122, 1.5760891077253887, 1.5759357561150327,
                                  1.5757853752888327, 1.5756699565460637, 1.5755307052383136, 1.5753967837397393, 1.5583690570941147,
                                  1.5584226798071374, 1.558473361232021, 1.5585203910671193, 1.5585639136599774, 1.5586049327255294,
                                  1.55863445798551, 1.5586701231807354, 1.558702914695222, 1.5587338280662084, 1.5587623520283835,
                                  1.5587891344167435, 1.5588130900930777, 1.558835566664688, 1.558851429716077, 1.558870826166999,
                                  1.5588884328582813, 1.558904869165472, 1.558919692439019, 1.5589330110976567, 1.5589452871531209,
                                  1.5589565213635153, 1.5589637027965266, 1.558972894875377, 1.5589807572209258, 1.558988018503825,
                                  1.5589940520218297, 1.5589993985526105, 1.5590037325137605, 1.5590063347354293, 1.5590094569893012,
                                  1.5590118334355625, 1.5590135906563192, 1.559014710764132, 1.5590152303224611, 1.5590151599898936,
                                  1.5590145433913845, 1.559013894095677, 1.5590124809247818, 1.5590105947150956, 1.5590082930930413,
                                  1.5590055195892767, 1.5590023240918758, 1.558998816142433, 1.5589948732836982, 1.5589922810395027,
                                  1.558987929486107, 1.5589832237913857, 1.558978268839512, 1.5589730090364546, 1.558967385339475,
                                  1.5589615915208803, 1.558955625179398, 1.5589493874661444, 1.5589428972538457, 1.5589363047609572,
                                  1.5589295154101268, 1.5589227769919654, 1.5589155401699593, 1.5589081790994392, 1.5589006563084469,
                                  1.5588931892649394, 1.5588854371823824, 1.558877511534894, 1.5588697245391794, 1.5588613395929305,
                                  1.558853142561024, 1.5588451349350854, 1.558836521051847, 1.5588281425489825, 1.5588195450283553,
                                  1.5588107634151385, 1.5588022431843587, 1.5587938407811415, 1.5587845885599756, 1.5587764885283297,
                                  1.5587865282850208, 1.5587784312271904, 1.5587697929567756, 1.558761161649626, 1.5587530369468057,
                                  1.5587446002176588, 1.5587359021989258, 1.55872685045934, 1.5587181426964083, 1.5587099269448828,
                                  1.5587011132066828, 1.5586972910822636, 1.5586887448604836, 1.5586798682146772, 1.5586713106232022,
                                  1.5586626279533347, 1.5586542481506236, 1.5586449744316941, 1.558635892445259, 1.5586276426991736,
                                  1.5586190622370526, 1.5586158950081883, 1.5586071381908206, 1.5585991177850003, 1.5585894905271531,
                                  1.5585819607624318, 1.5585727589386398, 1.5585642041137644, 1.5585557951779427, 1.558547990987258,
                                  1.5585387398367863, 1.558530470378228, 1.5585286788447938, 1.5585193877109138, 1.5585107847038517,
                                  1.5585030470759027, 1.5584949343080963, 1.558486299054185, 1.558478225026419, 1.5584694718734302,
                                  1.5584616695198088, 1.5584538079048478, 1.5584458215124266, 1.558437083355998, 1.5584283643929966,
                                  1.558420160456133, 1.5584118224045984, 1.558404458620395, 1.5583957269940745, 1.5583878502579878,
                                  1.558379661645924, 1.5583720163394434, 1.5583639148131074, 1.5583553551674398, 1.5583477612907792,
                                  1.5583400567389736, 1.5583323767578772, 1.5583242452032546, 1.558316837690181, 1.5583086319837713,
                                  1.5583007545902783, 1.558293349643379, 1.5582855227063797, 1.558278377106825, 1.5582711418491846,
                                  1.5582635569208747, 1.5582557228995366, 1.5582483017189641, 1.558240629945281, 1.558255412923722,
                                  1.5582480499988411, 1.5582418908173064, 1.5582351141865851, 1.558227087649952, 1.5582199025607146,
                                  1.5582130036840134, 1.5582057037863135, 1.5581993970516712, 1.5581920504772413, 1.5581847976407683,
                                  1.5581785304829174, 1.558172095721858, 1.5581642995312166, 1.5581579864544153, 1.5581504358421043,
                                  1.5581451309046304, 1.5581453810249588, 1.558139335156623, 1.5581329114102267, 1.5581264699444892,
                                  1.5581191559872196, 1.558112676336952, 1.5581061782697982, 1.5580989856404712, 1.5580940768902212]])
expected_corrected_beam_angles = np.array([[1.209080677036444, 1.2074367547912856, 1.2057926824074374, 1.2041484668971993, 1.20232941132059,
                                            1.2006849629047558, 1.1988655422323513, 1.1952978571496515, 1.1934783015554575, 1.1916585240856743,
                                            1.189838466342047, 1.1880184675225522, 1.1860233946020367, 1.1793094358006504, 1.1773141620314156,
                                            1.1753187333917494, 1.173497943365943, 1.171327405111851, 1.1693314237234094, 1.1673351545637423,
                                            1.1654557503188236, 1.1635409213210828, 1.1615985483718425, 1.1592044287326666, 1.1569914626234372,
                                            1.1549351316784935, 1.152376618011389, 1.1501116730164882, 1.1477310736098687, 1.1453784111662713,
                                            1.1429193812514824, 1.1386334531563977, 1.136089791028631, 1.1337725942547165, 1.1312419917047924,
                                            1.1285139975070437, 1.1261573494006858, 1.1234318496169073, 1.1190714142602687, 1.116598204888209,
                                            1.1137792822051271, 1.1107900575961096, 1.1081922134174274, 1.1052605178848942, 1.1007011717374586,
                                            1.097931737667016, 1.0950833392616364, 1.0921533597834323, 1.082503463032416, 1.0793491662873602,
                                            1.0762725369809587, 1.073004235044552, 1.0698669771179297, 1.0666357342859372, 1.0631441325919329,
                                            1.059875372377668, 1.0564555312930803, 1.0531478915216108, 1.0497064215239102, 1.0461142724619195,
                                            1.042705537200019, 1.038912087013376, 1.0353816168623906, 1.0315288842841719, 1.0276774730148168,
                                            1.023971169596549, 1.0200509964359248, 1.0160931972280096, 1.0121446035366466, 1.0080091308262698,
                                            1.0040183481267009, 0.999713271480497, 0.9956330681892489, 0.9913481563733447, 0.9868636759888099,
                                            0.9823867574328804, 0.9761716960117506, 0.9717002086643584, 0.9670728070881767, 0.9624026424520244,
                                            0.95756580792377, 0.9527527139763949, 0.947793379372962, 0.9409196570428088, 0.9359014630705927,
                                            0.9307097010781923, 0.9255227443961422, 0.9201331031012813, 0.9148153982678505, 0.9093249947959292,
                                            0.9018746910431208, 0.8961787299526928, 0.8904812557617534, 0.8847801737368218, 0.878693743899682,
                                            0.8727841204230611, 0.8665628278924267, 0.8587801826899268, 0.8523855402758597, 0.8459576695484856,
                                            0.8395303035968935, 0.8329381224695508, 0.8261876778881225, 0.8194328310315023, 0.8105973196608772,
                                            0.8036436919174605, 0.7965017800853107, 0.7891982626851367, 0.781906671890537, 0.7742714782857605,
                                            0.7667922568878788, 0.7590322733488188, 0.749251437008888, 0.7414050533200232, 0.7332104739628289,
                                            0.7250527596631395, 0.7166798207413367, 0.7081366476565172, 0.6996240293261609, 0.6905749148464835,
                                            0.6816973742657209, 0.6708833163698062, 0.6616431787083933, 0.6523999851890148, 0.6429801022455391,
                                            0.633370936782254, 0.623752066699906, 0.6137959772688711, 0.6038748467158523, 0.5937422715024869,
                                            0.5815149387870225, 0.5710383806720132, 0.5603846156210204, 0.5497178420800026, 0.5386954387116989,
                                            0.5276664386815988, 0.5164627943784152, 0.5050991067929642, 0.493734989490473, 0.4819979949504627,
                                            0.47026556954934495, 0.4562746579037149, 0.4441968394969813, 0.43193429643753234, 0.4196496659471458,
                                            0.4070305098032927, 0.3944064856895364, 0.3815866063912432, 0.3686108873849747, 0.3554770783817991,
                                            0.34229615212522235, 0.3289523437391062, 0.3154468738087819, 0.30179338027680447, 0.28806264686698557,
                                            0.27417386720175463, 0.2602894313996025, 0.24432257025961657, 0.23006255801313258, 0.21578686212887166,
                                            0.20140250124972492, 0.18700472876842977, 0.17238898836669403, 0.15777018731160863, 0.14315269648278361,
                                            0.12836154994408244, 0.11357040616461322, 0.09860015838755043, 0.08384314351200195, 0.0688737095244869,
                                            0.05392860832621538, 0.03883328544603937, 0.024024876653464755, 0.009816732513239446, 0.008272646754185375,
                                            -0.022228375665103606, -0.037209213765722726, -0.05214417805406968, -0.06711884371889498, -0.08212475401466324,
                                            -0.09714214977873303, -0.11202884093282295, -0.12684708662642952, -0.14167666474198382, -0.1565788098220331,
                                            -0.17125719242968307, -0.18591344756966843, -0.20061932878219602, -0.21496537324149045, -0.2294783000318381,
                                            -0.2417660440625804, -0.2559810885773952, -0.2701842053820993, -0.2842812003880659, -0.29816366168050057,
                                            -0.3120332692183958, -0.3257291912397764, -0.3392720681931598, -0.352628205680265, -0.3660046873579881,
                                            -0.37920682446469733, -0.3922452021193883, -0.40505122744518696, -0.4179695616144887, -0.4306551938838272,
                                            -0.44109802534057585, -0.4536175251775336, -0.46579967822351365, -0.47779082068996837, -0.48978491799436386,
                                            -0.5016397370536079, -0.5133122465537245, -0.5248215593480945, -0.5361328894272608, -0.5472834839662979,
                                            -0.5584498619354556, -0.5675159606606699, -0.5781620819439849, -0.5887876632299297, -0.5993979880415753,
                                            -0.6097075049727342, -0.6200079053451584, -0.6299519087692927, -0.6399029477930268, -0.649693453181302,
                                            -0.6595057776035774, -0.6671811851742914, -0.676610858665124, -0.6858567582810283, -0.695046621397597,
                                            -0.7039688841273958, -0.7128836423919108, -0.7216349616006995, -0.7302042602984447, -0.738756478926864,
                                            -0.7452384713294778, -0.7534843846681457, -0.7615259873566552, -0.7695765115262172, -0.7774768920504329,
                                            -0.7853794004344771, -0.7929167112946754, -0.8004661303669699, -0.8061215489243065, -0.8134707842652065,
                                            -0.8206342062312408, -0.8278364916420516, -0.8348556980183736, -0.8416881187392142, -0.8485389172901053,
                                            -0.8554007948224072, -0.8601627733348914, -0.8668045488018277, -0.8731207395553827, -0.879668726132101,
                                            -0.8858450184282843, -0.8921372449701582, -0.8981039625562036, -0.9022658943392547, -0.908187418990433,
                                            -0.9139186265216092, -0.9196802434404496, -0.9253654537449935, -0.9310404718438526, -0.936707287915953,
                                            -0.9421620195832142, -0.9455339753310197, -0.9507941441844496, -0.9560234450067442, -0.9611304831291528,
                                            -0.9662767441954088, -0.9713811181394174, -0.9763173834556966, -0.9812870979296426, -0.9843021212907316,
                                            -0.9890184494019423, -0.9937270697828987, -0.9983368492220523, -1.0029171403869053, -1.0075215709042258,
                                            -1.0120020109223775, -1.0163823935810532, -1.020744948187896, -1.0250793580868565, -1.0292988520457191,
                                            -1.033474343795151, -1.0374671431385671, -1.0416044566549583, -1.0456712522625873, -1.0496945659437884,
                                            -1.0535673605465021, -1.0574723902574767, -1.0613541634582049, -1.0650678457908604, -1.068964813722342,
                                            -1.0726802028433267, -1.076226377865201, -1.0799557661976293, -1.0835042110743458, -1.0870697443940334,
                                            -1.0906376959051864, -1.0940323950744064, -1.0973200455535643, -1.1008738764686148, -1.103932375438498,
                                            -1.1001319817671558, -1.103201034182952, -1.1064226330424074, -1.109589204033786, -1.1125253339606596,
                                            -1.115531023966896, -1.1185837586660483, -1.1217153406036136, -1.1246855523952857, -1.1274516949191202,
                                            -1.1303816585171969, -1.1316396539023637, -1.1344294637629684, -1.1372916103291826, -1.140018978450768,
                                            -1.1427546414814327, -1.145365528082103, -1.1482225568774989, -1.150988518372068, -1.1534762781052703,
                                            -1.1560378536597127, -1.1569759123688748, -1.159554791171585, -1.1618950031471504, -1.1646757132766958,
                                            -1.1668326242167848, -1.169442907151194, -1.171848466426916, -1.1741930990554026, -1.1763516866976473,
                                            -1.1788883224217002, -1.1811372575690642, -1.1816216489663256, -1.1841231874770561, -1.1864205164606074,
                                            -1.1884726537001575, -1.1906078588268338, -1.192864283498257, -1.1949587831762047, -1.1972134246422943,
                                            -1.1992096062217532, -1.2012079897446042, -1.2032249657908536, -1.205416264868276, -1.2075878152661554,
                                            -1.2096182747895807, -1.2116687761841625, -1.2134692254820512, -1.2155906624454587, -1.21749281277741,
                                            -1.2194584671613669, -1.2212838555660332, -1.2232069396415919, -1.2252265123497348, -1.2270091530277427,
                                            -1.228808233983022, -1.2305915161343681, -1.2324700844344727, -1.2341725362440228, -1.2360488672875647,
                                            -1.237840318416913, -1.2395165432997142, -1.2412801548670487, -1.242882607911297, -1.2444970840930933,
                                            -1.246182370924494, -1.2479146291603729, -1.2495484383840363, -1.2512295945999676, -1.2479811800807667,
                                            -1.249601953083115, -1.2509526511977074, -1.2524324586492028, -1.2541772463044272, -1.255732184713361,
                                            -1.25721937786204, -1.2587862929867235, -1.26013564141502, -1.2617004473006426, -1.263239087509698,
                                            -1.2645637248989439, -1.2659196623984523, -1.2675548586974343, -1.2688743309837573, -1.2704463224270937,
                                            -1.2715480299832325, -1.271494911987489, -1.2727461717801598, -1.2740709625215385, -1.2753949394965653,
                                            -1.2768929367212183, -1.278215290158759, -1.2795369980754572, -1.2809943563046988, -1.28198682800142]])
expected_alongtrack = np.array([[-3.45, -3.436, -3.422, -3.408, -3.394, -3.38, -3.366, -3.356, -3.342, -3.328,
                                 -3.314, -3.3, -3.287, -3.282, -3.268, -3.255, -3.241, -3.227, -3.213, -3.199,
                                 -3.167, -3.148, -3.119, -3.12, -3.109, -3.088, -3.088, -3.08, -3.069, -3.056,
                                 -3.05, -3.04, -3.04, -3.013, -3.011, -3.0, -2.975, -2.975, -2.959, -2.942,
                                 -2.937, -2.932, -2.911, -2.902, -2.887, -2.867, -2.852, -2.842, -2.802, -2.795,
                                 -2.784, -2.774, -2.766, -2.753, -2.746, -2.736, -2.724, -2.704, -2.694, -2.682,
                                 -2.669, -2.659, -2.643, -2.637, -2.63, -2.614, -2.601, -2.59, -2.578, -2.568,
                                 -2.559, -2.548, -2.533, -2.521, -2.51, -2.499, -2.489, -2.477, -2.464, -2.454,
                                 -2.444, -2.432, -2.417, -2.405, -2.395, -2.385, -2.374, -2.366, -2.352, -2.338,
                                 -2.329, -2.317, -2.306, -2.294, -2.286, -2.277, -2.265, -2.254, -2.243, -2.233,
                                 -2.224, -2.214, -2.202, -2.191, -2.181, -2.171, -2.163, -2.154, -2.144, -2.133,
                                 -2.124, -2.109, -2.104, -2.095, -2.087, -2.076, -2.068, -2.06, -2.049, -0.339,
                                 -0.342, -0.346, -0.349, -0.353, -0.356, -0.359, -0.362, -0.366, -0.368, -0.371,
                                 -0.375, -0.378, -0.38, -0.383, -0.386, -0.389, -0.392, -0.394, -0.396, -0.399,
                                 -0.402, -0.405, -0.407, -0.409, -0.411, -0.414, -0.416, -0.418, -0.42, -0.421,
                                 -0.424, -0.425, -0.427, -0.428, -0.43, -0.432, -0.433, -0.435, -0.436, -0.438,
                                 -0.439, -0.439, -0.44, -0.441, -0.443, -0.443, -0.444, -0.445, -0.445, -0.445,
                                 -0.446, -0.446, -0.447, -0.447, -0.447, -0.447, -0.447, -0.447, -0.446, -0.446,
                                 -0.445, -0.446, -0.444, -0.443, -0.443, -0.441, -0.443, -0.441, -0.44, -0.438,
                                 -0.437, -0.436, -0.434, -0.434, -0.432, -0.43, -0.429, -0.427, -0.425, -0.423,
                                 -0.421, -0.419, -0.416, -0.415, -0.413, -0.411, -0.409, -0.406, -0.404, -0.401,
                                 -0.399, -0.396, -0.393, -0.39, -0.388, -0.385, -0.383, -0.38, -0.377, -0.373,
                                 -0.37, -0.367, -0.364, -0.361, -0.357, -0.354, -0.352, -0.348, -0.344, 0.947,
                                 0.96, 0.973, 0.986, 0.999, 1.012, 1.023, 1.038, 1.051, 1.064, 1.078,
                                 1.093, 1.107, 1.121, 1.135, 1.149, 1.162, 1.176, 1.191, 1.205, 1.219,
                                 1.235, 1.248, 1.261, 1.275, 1.292, 1.308, 1.322, 1.336, 1.353, 1.366,
                                 1.378, 1.391, 1.408, 1.425, 1.442, 1.457, 1.47, 1.484, 1.497, 1.512,
                                 1.529, 1.544, 1.56, 1.576, 1.59, 1.603, 1.616, 1.632, 1.647, 1.664,
                                 1.682, 1.696, 1.709, 1.729, 1.743, 1.756, 1.768, 1.787, 1.803, 1.816,
                                 1.831, 1.847, 1.862, 1.877, 1.893, 1.909, 1.925, 1.941, 1.957, 1.974,
                                 1.99, 2.007, 2.019, 2.035, 2.044, 2.049, 2.058, 2.067, 2.081, 2.092,
                                 2.098, 2.115, 2.128, 2.141, 2.152, 2.163, 2.176, 2.188, 2.205, 2.214,
                                 2.224, 2.236, 2.253, 2.273, 2.279, 2.289, 2.302, 2.313, 2.32, 2.342,
                                 2.34, 2.361, 2.372, 2.379, 2.386, 2.404, 2.415, 2.423, 2.439, 2.453,
                                 2.454, 2.469, 2.481, 2.493, 2.505, 2.512, 2.52, 2.528, 2.546, 2.563,
                                 2.572, 2.582, 2.588, 2.602, 2.614, 2.629, 2.636, 2.649, 2.666, 2.672,
                                 2.678, 2.692, 2.702, 2.712, 2.722, 2.737, 2.746, 2.75, 2.755, 2.769,
                                 2.778, 2.79, 2.796, 2.805, 2.812, 2.818, 2.818, 2.825, 2.837, 2.849,
                                 2.856, 2.868, 2.868, 2.88, 2.891, 2.899, 2.899, 2.915, 2.923, 2.935,
                                 2.931, 2.947, 2.951, 2.959, 2.967, 2.975, 2.983, 2.991, 3.007, 3.006]])
expected_acrosstrack = np.array([[-234.877, -233.551, -232.226, -230.903, -229.566, -228.247, -226.914, -225.427, -224.098, -222.77,
                                  -221.445, -220.121, -218.784, -217.028, -215.696, -214.365, -213.052, -211.71, -210.386, -209.064,
                                  -206.546, -204.898, -202.641, -202.215, -201.056, -199.266, -198.784, -197.838, -196.64, -195.331,
                                  -194.45, -193.02, -192.479, -190.32, -189.728, -188.5, -186.507, -185.982, -184.149, -182.626,
                                  -181.766, -180.873, -179.143, -178.027, -176.288, -174.539, -173.102, -171.986, -167.823, -166.892,
                                  -165.66, -164.48, -163.486, -162.166, -161.163, -159.991, -158.715, -157.013, -155.825, -154.532,
                                  -153.224, -152.021, -150.502, -149.528, -148.549, -147.027, -145.64, -144.396, -143.121, -141.878,
                                  -140.764, -139.491, -138.051, -136.711, -135.449, -134.162, -132.694, -131.393, -130.012, -128.789,
                                  -127.524, -126.178, -124.719, -123.071, -121.829, -120.57, -119.298, -118.111, -116.677, -115.226,
                                  -113.745, -112.394, -111.052, -109.727, -108.497, -107.278, -105.906, -104.366, -102.985, -101.717,
                                  -100.451, -99.142, -97.77, -96.417, -94.837, -93.556, -92.306, -91.004, -89.67, -88.294,
                                  -86.995, -85.466, -84.072, -82.812, -81.522, -80.131, -78.847, -77.54, -76.153, -74.704,
                                  -73.341, -71.856, -70.51, -69.178, -67.841, -66.533, -65.255, -63.92, -62.505, -61.173,
                                  -59.657, -58.293, -56.927, -55.596, -54.255, -52.934, -51.603, -50.232, -48.869, -47.529,
                                  -46.186, -44.624, -43.256, -41.898, -40.585, -39.22, -37.869, -36.542, -35.175, -33.774,
                                  -32.449, -31.095, -29.714, -28.292, -26.97, -25.617, -24.262, -22.71, -21.359, -20.023,
                                  -18.619, -17.234, -15.869, -14.509, -13.151, -11.779, -10.409, -9.029, -7.656, -6.284,
                                  -4.91, -3.522, -2.15, -0.778, 0.61, 1.983, 3.375, 4.753, 6.132, 7.517,
                                  8.905, 10.302, 11.658, 13.016, 14.429, 15.788, 17.271, 18.665, 20.017, 21.376,
                                  22.578, 23.969, 25.35, 26.809, 28.207, 29.592, 30.966, 32.362, 33.728, 35.132,
                                  36.527, 37.931, 39.218, 40.72, 42.105, 43.338, 44.736, 46.131, 47.482, 48.845,
                                  50.275, 51.68, 53.101, 54.459, 55.839, 57.264, 58.489, 59.889, 61.243, 62.562,
                                  63.981, 65.383, 66.739, 68.12, 69.53, 71.008, 72.181, 73.544, 74.869, 76.213,
                                  77.586, 78.942, 80.322, 81.667, 82.965, 84.151, 85.559, 86.863, 88.198, 89.601,
                                  91.016, 92.352, 93.731, 95.028, 96.317, 97.555, 98.927, 100.259, 101.536, 102.88,
                                  104.266, 105.449, 106.669, 107.941, 109.434, 110.82, 112.018, 113.27, 114.767, 115.863,
                                  116.888, 118.024, 119.504, 120.951, 122.371, 123.641, 124.771, 125.956, 127.027, 128.279,
                                  129.681, 130.928, 132.186, 133.573, 134.662, 135.738, 136.786, 138.109, 139.321, 140.627,
                                  142.116, 143.22, 144.256, 145.847, 146.994, 147.969, 148.897, 150.394, 151.615, 152.666,
                                  153.798, 155.059, 156.228, 157.41, 158.642, 159.833, 161.031, 162.28, 163.49, 164.77,
                                  166.061, 167.343, 168.195, 169.431, 170.047, 170.58, 171.241, 171.826, 172.882, 173.697,
                                  174.097, 175.387, 176.301, 177.255, 178.073, 178.862, 179.811, 180.728, 181.943, 182.603,
                                  183.296, 184.182, 185.377, 186.904, 187.281, 187.962, 189.012, 189.765, 190.239, 191.832,
                                  191.542, 193.139, 193.883, 194.374, 194.802, 196.094, 196.899, 197.492, 198.639, 199.648,
                                  199.628, 200.676, 201.513, 202.391, 203.221, 203.684, 204.156, 204.706, 205.991, 207.194,
                                  207.801, 208.492, 208.851, 209.842, 210.631, 211.69, 212.154, 213.031, 214.319, 214.6,
                                  214.951, 215.964, 216.652, 217.322, 217.999, 219.048, 219.605, 219.802, 220.043, 221.069,
                                  221.664, 222.459, 222.833, 223.409, 224.213, 224.532, 224.43, 224.88, 225.729, 226.5,
                                  226.982, 227.805, 227.694, 228.507, 229.208, 229.728, 229.645, 230.76, 231.257, 232.101,
                                  231.661, 232.912, 233.116, 233.635, 234.151, 234.676, 235.185, 235.69, 236.78, 236.608]])
expected_depth = np.array([[88.878, 88.816, 88.749, 88.679, 88.645, 88.568, 88.526, 88.874, 88.821, 88.765,
                            88.704, 88.639, 88.608, 89.598, 89.552, 89.502, 89.41, 89.387, 89.324, 89.255,
                            88.64, 88.398, 87.891, 88.282, 88.307, 88.01, 88.406, 88.522, 88.549, 88.513,
                            88.691, 89.04, 89.385, 88.919, 89.228, 89.28, 88.874, 89.247, 89.358, 89.177,
                            89.393, 89.627, 89.35, 89.446, 89.582, 89.302, 89.19, 89.254, 89.16, 89.341,
                            89.338, 89.398, 89.523, 89.483, 89.665, 89.699, 89.699, 89.423, 89.459, 89.456,
                            89.398, 89.471, 89.294, 89.496, 89.69, 89.516, 89.456, 89.482, 89.475, 89.517,
                            89.601, 89.638, 89.511, 89.476, 89.52, 89.536, 89.753, 89.732, 89.675, 89.722,
                            89.76, 89.724, 89.621, 89.727, 89.761, 89.804, 89.822, 89.93, 89.823, 89.718,
                            89.934, 89.912, 89.881, 89.849, 89.95, 90.015, 89.993, 90.093, 90.057, 90.109,
                            90.147, 90.159, 90.125, 90.091, 90.198, 90.227, 90.303, 90.34, 90.325, 90.308,
                            90.321, 90.123, 90.409, 90.468, 90.538, 90.467, 90.534, 90.585, 90.514, 90.409,
                            90.381, 90.535, 90.544, 90.548, 90.555, 90.61, 90.685, 90.722, 90.61, 90.629,
                            90.758, 90.74, 90.724, 90.74, 90.782, 90.832, 90.874, 90.848, 90.805, 90.855,
                            90.868, 90.922, 90.894, 90.897, 90.97, 90.979, 90.989, 91.075, 91.071, 90.982,
                            91.074, 91.102, 91.061, 90.892, 91.034, 91.092, 91.112, 91.11, 91.213, 91.368,
                            91.218, 91.108, 91.177, 91.243, 91.289, 91.321, 91.343, 91.385, 91.255, 91.319,
                            91.33, 91.385, 91.393, 91.41, 91.432, 91.412, 91.452, 91.472, 91.463, 91.489,
                            91.5, 91.658, 91.476, 91.311, 91.438, 91.323, 91.854, 91.809, 91.699, 91.531,
                            91.579, 91.597, 91.543, 91.762, 91.793, 91.748, 91.69, 91.706, 91.656, 91.669,
                            91.668, 91.696, 91.474, 91.689, 91.653, 91.798, 91.764, 91.772, 91.703, 91.625,
                            91.673, 91.679, 91.717, 91.655, 91.635, 91.655, 91.754, 91.78, 91.71, 91.567,
                            91.601, 91.584, 91.544, 91.512, 91.521, 91.587, 91.639, 91.58, 91.484, 91.405,
                            91.382, 91.317, 91.285, 91.226, 91.095, 91.203, 91.209, 91.119, 91.041, 91.038,
                            91.026, 90.98, 90.955, 91.176, 91.062, 90.918, 90.874, 90.808, 90.71, 90.651,
                            90.609, 90.759, 90.582, 90.496, 90.534, 90.534, 90.343, 90.243, 90.657, 90.414,
                            90.141, 89.937, 89.995, 90.014, 89.998, 89.896, 90.076, 89.927, 89.693, 89.599,
                            89.589, 89.467, 89.372, 89.346, 89.488, 89.283, 89.052, 89.01, 88.89, 88.815,
                            88.867, 88.688, 88.461, 88.569, 88.418, 88.165, 87.915, 87.961, 87.85, 87.641,
                            87.5, 87.418, 87.28, 87.174, 87.051, 86.933, 86.846, 86.74, 86.642, 86.569,
                            86.493, 86.44, 86.18, 86.055, 85.715, 86.798, 86.473, 86.075, 85.921, 85.69,
                            85.238, 85.207, 84.969, 84.781, 84.568, 84.302, 84.473, 84.289, 84.222, 83.924,
                            83.636, 83.459, 83.363, 83.429, 83.039, 82.766, 83.017, 82.764, 82.442, 82.499,
                            81.885, 81.972, 81.738, 81.409, 81.094, 81.049, 80.864, 80.996, 80.886, 80.763,
                            80.278, 80.202, 80.01, 79.868, 79.667, 79.379, 79.094, 78.832, 78.81, 78.754,
                            78.503, 78.276, 77.981, 77.845, 77.682, 77.6, 77.331, 77.187, 77.164, 76.834,
                            76.523, 76.45, 76.236, 76.056, 75.834, 75.759, 75.54, 75.175, 74.863, 74.815,
                            74.6, 74.438, 74.159, 73.934, 75.009, 74.711, 74.341, 74.121, 73.964, 73.827,
                            73.611, 73.483, 73.108, 72.975, 72.811, 72.641, 72.272, 72.208, 72.029, 71.892,
                            71.476, 71.876, 71.619, 71.44, 71.259, 71.035, 70.849, 70.662, 70.613, 70.306]])
expected_georef_x = np.array([[553033.754, 553034.56, 553035.366, 553036.17, 553036.983, 553037.785, 553038.596, 553039.505, 553040.313, 553041.12,
                               553041.926, 553042.731, 553043.545, 553044.623, 553045.433, 553046.244, 553047.042, 553047.858, 553048.663, 553049.467,
                               553050.994, 553051.995, 553053.363, 553053.626, 553054.332, 553055.419, 553055.716, 553056.293, 553057.023, 553057.819,
                               553058.357, 553059.231, 553059.564, 553060.874, 553061.237, 553061.986, 553063.194, 553063.518, 553064.635, 553065.561,
                               553066.087, 553066.633, 553067.683, 553068.364, 553069.424, 553070.486, 553071.36, 553072.04, 553074.575, 553075.143,
                               553075.894, 553076.613, 553077.22, 553078.023, 553078.636, 553079.35, 553080.127, 553081.161, 553081.885, 553082.672,
                               553083.468, 553084.202, 553085.126, 553085.721, 553086.319, 553087.245, 553088.09, 553088.848, 553089.624, 553090.382,
                               553091.062, 553091.838, 553092.714, 553093.53, 553094.299, 553095.084, 553095.981, 553096.774, 553097.615, 553098.36,
                               553099.132, 553099.953, 553100.84, 553101.846, 553102.604, 553103.372, 553104.148, 553104.873, 553105.746, 553106.629,
                               553107.535, 553108.358, 553109.177, 553109.984, 553110.736, 553111.48, 553112.316, 553113.257, 553114.099, 553114.873,
                               553115.646, 553116.445, 553117.282, 553118.107, 553119.073, 553119.855, 553120.619, 553121.414, 553122.229, 553123.068,
                               553123.862, 553124.792, 553125.648, 553126.417, 553127.206, 553128.055, 553128.84, 553129.639, 553130.485, 553130.033,
                               553130.875, 553131.794, 553132.626, 553133.45, 553134.276, 553135.085, 553135.875, 553136.701, 553137.575, 553138.398,
                               553139.336, 553140.179, 553141.023, 553141.845, 553142.674, 553143.491, 553144.314, 553145.16, 553146.002, 553146.83,
                               553147.66, 553148.625, 553149.47, 553150.309, 553151.12, 553151.963, 553152.798, 553153.617, 553154.461, 553155.326,
                               553156.145, 553156.98, 553157.833, 553158.71, 553159.527, 553160.362, 553161.198, 553162.156, 553162.99, 553163.815,
                               553164.681, 553165.535, 553166.377, 553167.216, 553168.055, 553168.9, 553169.746, 553170.597, 553171.443, 553172.289,
                               553173.137, 553173.992, 553174.839, 553175.684, 553176.54, 553177.386, 553178.244, 553179.093, 553179.943, 553180.796,
                               553181.651, 553182.513, 553183.347, 553184.183, 553185.054, 553185.891, 553186.806, 553187.664, 553188.496, 553189.332,
                               553190.073, 553190.929, 553191.779, 553192.678, 553193.538, 553194.39, 553195.236, 553196.095, 553196.936, 553197.8,
                               553198.658, 553199.522, 553200.313, 553201.238, 553202.09, 553202.848, 553203.708, 553204.566, 553205.397, 553206.235,
                               553207.115, 553207.978, 553208.852, 553209.686, 553210.535, 553211.411, 553212.165, 553213.025, 553213.858, 553214.667,
                               553215.54, 553216.402, 553217.235, 553218.084, 553218.95, 553219.858, 553220.58, 553221.417, 553222.23, 553222.043,
                               553222.879, 553223.704, 553224.545, 553225.364, 553226.153, 553226.876, 553227.732, 553228.525, 553229.338, 553230.192,
                               553231.052, 553231.865, 553232.704, 553233.492, 553234.276, 553235.028, 553235.863, 553236.672, 553237.448, 553238.266,
                               553239.107, 553239.826, 553240.568, 553241.341, 553242.248, 553243.09, 553243.817, 553244.578, 553245.487, 553246.153,
                               553246.775, 553247.465, 553248.364, 553249.242, 553250.104, 553250.875, 553251.561, 553252.281, 553252.931, 553253.691,
                               553254.541, 553255.298, 553256.061, 553256.903, 553257.564, 553258.217, 553258.852, 553259.655, 553260.39, 553261.182,
                               553262.086, 553262.755, 553263.383, 553264.348, 553265.044, 553265.635, 553266.198, 553267.105, 553267.845, 553268.483,
                               553269.169, 553269.934, 553270.642, 553271.359, 553272.106, 553272.827, 553273.553, 553274.31, 553275.044, 553275.819,
                               553276.602, 553277.379, 553277.895, 553278.644, 553279.017, 553279.341, 553279.742, 553280.095, 553280.735, 553281.229,
                               553281.471, 553282.252, 553282.806, 553283.383, 553283.879, 553284.357, 553284.931, 553285.487, 553286.223, 553286.622,
                               553287.042, 553287.578, 553288.301, 553289.227, 553289.455, 553289.866, 553290.503, 553290.959, 553291.246, 553292.21,
                               553292.033, 553293.001, 553293.451, 553293.748, 553294.006, 553294.788, 553295.276, 553295.635, 553296.329, 553296.94,
                               553296.927, 553297.561, 553298.068, 553298.6, 553299.102, 553299.382, 553299.666, 553299.999, 553300.777, 553301.505,
                               553301.872, 553302.29, 553302.507, 553303.106, 553303.583, 553304.224, 553304.505, 553305.035, 553305.816, 553305.984,
                               553306.196, 553306.809, 553307.225, 553307.63, 553308.04, 553308.675, 553309.011, 553309.129, 553309.274, 553309.895,
                               553310.255, 553310.735, 553310.961, 553311.309, 553311.799, 553311.991, 553311.928, 553312.2, 553312.714, 553313.18,
                               553313.471, 553313.969, 553313.901, 553314.392, 553314.816, 553315.13, 553315.079, 553315.754, 553316.054, 553316.564,
                               553316.296, 553317.055, 553317.177, 553317.491, 553317.803, 553318.12, 553318.428, 553318.733, 553319.392, 553319.287]])
expected_georef_y = np.array([[-2653665.442, -2653664.39, -2653663.338, -2653662.289, -2653661.228, -2653660.181, -2653659.123, -2653657.947, -2653656.893, -2653655.839,
                               -2653654.787, -2653653.737, -2653652.677, -2653651.292, -2653650.235, -2653649.179, -2653648.137, -2653647.072, -2653646.022, -2653644.973,
                               -2653642.972, -2653641.663, -2653639.869, -2653639.534, -2653638.615, -2653637.194, -2653636.814, -2653636.065, -2653635.115, -2653634.077,
                               -2653633.38, -2653632.248, -2653631.823, -2653630.107, -2653629.64, -2653628.667, -2653627.083, -2653626.67, -2653625.217, -2653624.008,
                               -2653623.328, -2653622.622, -2653621.248, -2653620.364, -2653618.986, -2653617.598, -2653616.457, -2653615.573, -2653612.272, -2653611.535,
                               -2653610.559, -2653609.624, -2653608.837, -2653607.79, -2653606.996, -2653606.068, -2653605.056, -2653603.704, -2653602.763, -2653601.738,
                               -2653600.701, -2653599.748, -2653598.543, -2653597.772, -2653596.998, -2653595.79, -2653594.69, -2653593.705, -2653592.694, -2653591.709,
                               -2653590.827, -2653589.819, -2653588.676, -2653587.614, -2653586.614, -2653585.595, -2653584.433, -2653583.402, -2653582.307, -2653581.338,
                               -2653580.337, -2653579.27, -2653578.113, -2653576.808, -2653575.825, -2653574.828, -2653573.82, -2653572.881, -2653571.744, -2653570.593,
                               -2653569.422, -2653568.351, -2653567.288, -2653566.238, -2653565.265, -2653564.3, -2653563.213, -2653561.995, -2653560.901, -2653559.897,
                               -2653558.895, -2653557.859, -2653556.772, -2653555.7, -2653554.45, -2653553.436, -2653552.447, -2653551.417, -2653550.361, -2653549.272,
                               -2653548.244, -2653547.031, -2653545.931, -2653544.934, -2653543.914, -2653542.812, -2653541.797, -2653540.763, -2653539.665, -2653537.471,
                               -2653536.4, -2653535.234, -2653534.176, -2653533.13, -2653532.08, -2653531.052, -2653530.049, -2653529.0, -2653527.888, -2653526.842,
                               -2653525.651, -2653524.579, -2653523.506, -2653522.46, -2653521.406, -2653520.369, -2653519.323, -2653518.245, -2653517.174, -2653516.121,
                               -2653515.066, -2653513.839, -2653512.763, -2653511.696, -2653510.664, -2653509.591, -2653508.529, -2653507.486, -2653506.412, -2653505.31,
                               -2653504.269, -2653503.204, -2653502.118, -2653501.0, -2653499.961, -2653498.897, -2653497.831, -2653496.611, -2653495.549, -2653494.498,
                               -2653493.394, -2653492.304, -2653491.231, -2653490.161, -2653489.093, -2653488.014, -2653486.936, -2653485.851, -2653484.77, -2653483.69,
                               -2653482.61, -2653481.517, -2653480.438, -2653479.358, -2653478.266, -2653477.186, -2653476.09, -2653475.006, -2653473.92, -2653472.83,
                               -2653471.737, -2653470.638, -2653469.57, -2653468.5, -2653467.388, -2653466.318, -2653465.152, -2653464.053, -2653462.989, -2653461.918,
                               -2653460.971, -2653459.876, -2653458.788, -2653457.64, -2653456.538, -2653455.447, -2653454.365, -2653453.265, -2653452.189, -2653451.083,
                               -2653449.984, -2653448.878, -2653447.863, -2653446.68, -2653445.589, -2653444.618, -2653443.516, -2653442.416, -2653441.352, -2653440.277,
                               -2653439.151, -2653438.043, -2653436.923, -2653435.853, -2653434.765, -2653433.642, -2653432.677, -2653431.573, -2653430.506, -2653429.465,
                               -2653428.347, -2653427.241, -2653426.172, -2653425.084, -2653423.972, -2653422.807, -2653421.882, -2653420.807, -2653419.762, -2653417.908,
                               -2653416.82, -2653415.745, -2653414.651, -2653413.584, -2653412.555, -2653411.614, -2653410.497, -2653409.463, -2653408.404, -2653407.291,
                               -2653406.169, -2653405.109, -2653404.015, -2653402.985, -2653401.962, -2653400.98, -2653399.892, -2653398.834, -2653397.82, -2653396.754,
                               -2653395.654, -2653394.714, -2653393.746, -2653392.737, -2653391.551, -2653390.451, -2653389.499, -2653388.505, -2653387.317, -2653386.446,
                               -2653385.632, -2653384.73, -2653383.555, -2653382.406, -2653381.278, -2653380.269, -2653379.372, -2653378.43, -2653377.579, -2653376.585,
                               -2653375.471, -2653374.48, -2653373.481, -2653372.379, -2653371.513, -2653370.659, -2653369.826, -2653368.775, -2653367.812, -2653366.773,
                               -2653365.591, -2653364.713, -2653363.89, -2653362.625, -2653361.714, -2653360.939, -2653360.201, -2653359.011, -2653358.04, -2653357.205,
                               -2653356.305, -2653355.303, -2653354.374, -2653353.434, -2653352.455, -2653351.508, -2653350.555, -2653349.562, -2653348.6, -2653347.582,
                               -2653346.556, -2653345.537, -2653344.859, -2653343.876, -2653343.386, -2653342.964, -2653342.438, -2653341.972, -2653341.132, -2653340.484,
                               -2653340.166, -2653339.14, -2653338.413, -2653337.654, -2653337.003, -2653336.375, -2653335.621, -2653334.892, -2653333.925, -2653333.4,
                               -2653332.848, -2653332.144, -2653331.193, -2653329.979, -2653329.678, -2653329.136, -2653328.302, -2653327.703, -2653327.325, -2653326.058,
                               -2653326.287, -2653325.018, -2653324.425, -2653324.035, -2653323.693, -2653322.666, -2653322.025, -2653321.554, -2653320.641, -2653319.838,
                               -2653319.854, -2653319.02, -2653318.353, -2653317.655, -2653316.994, -2653316.626, -2653316.249, -2653315.812, -2653314.789, -2653313.832,
                               -2653313.349, -2653312.799, -2653312.513, -2653311.724, -2653311.096, -2653310.253, -2653309.884, -2653309.185, -2653308.161, -2653307.936,
                               -2653307.657, -2653306.851, -2653306.303, -2653305.77, -2653305.231, -2653304.396, -2653303.952, -2653303.794, -2653303.602, -2653302.786,
                               -2653302.312, -2653301.679, -2653301.381, -2653300.922, -2653300.285, -2653300.03, -2653300.11, -2653299.752, -2653299.076, -2653298.462,
                               -2653298.079, -2653297.423, -2653297.511, -2653296.864, -2653296.305, -2653295.891, -2653295.956, -2653295.069, -2653294.673, -2653294.001,
                               -2653294.35, -2653293.356, -2653293.193, -2653292.779, -2653292.368, -2653291.95, -2653291.545, -2653291.142, -2653290.275, -2653290.411]])
expected_georef_z = np.array([[90.528, 90.466, 90.399, 90.329, 90.295, 90.218, 90.176, 90.524, 90.471, 90.415,
                               90.354, 90.289, 90.258, 91.248, 91.202, 91.152, 91.06, 91.037, 90.974, 90.905,
                               90.29, 90.048, 89.541, 89.932, 89.957, 89.66, 90.056, 90.172, 90.199, 90.163,
                               90.341, 90.69, 91.035, 90.569, 90.878, 90.93, 90.524, 90.897, 91.008, 90.827,
                               91.043, 91.277, 91.0, 91.096, 91.232, 90.952, 90.84, 90.904, 90.81, 90.991,
                               90.988, 91.048, 91.173, 91.133, 91.315, 91.349, 91.349, 91.073, 91.109, 91.106,
                               91.048, 91.121, 90.944, 91.146, 91.34, 91.166, 91.106, 91.132, 91.125, 91.167,
                               91.251, 91.288, 91.161, 91.126, 91.17, 91.186, 91.403, 91.382, 91.325, 91.372,
                               91.41, 91.374, 91.271, 91.377, 91.411, 91.454, 91.472, 91.58, 91.473, 91.368,
                               91.584, 91.562, 91.531, 91.499, 91.6, 91.665, 91.643, 91.743, 91.707, 91.759,
                               91.797, 91.809, 91.775, 91.741, 91.848, 91.877, 91.953, 91.99, 91.975, 91.958,
                               91.971, 91.773, 92.059, 92.118, 92.188, 92.117, 92.184, 92.235, 92.164, 92.059,
                               92.031, 92.185, 92.194, 92.198, 92.205, 92.26, 92.335, 92.372, 92.26, 92.279,
                               92.408, 92.39, 92.374, 92.39, 92.432, 92.482, 92.524, 92.498, 92.455, 92.505,
                               92.518, 92.572, 92.544, 92.547, 92.62, 92.629, 92.639, 92.725, 92.721, 92.632,
                               92.724, 92.752, 92.711, 92.542, 92.684, 92.742, 92.762, 92.76, 92.863, 93.018,
                               92.868, 92.758, 92.827, 92.893, 92.939, 92.971, 92.993, 93.035, 92.905, 92.969,
                               92.98, 93.035, 93.043, 93.06, 93.082, 93.062, 93.102, 93.122, 93.113, 93.139,
                               93.15, 93.308, 93.126, 92.961, 93.088, 92.973, 93.504, 93.459, 93.349, 93.181,
                               93.229, 93.247, 93.193, 93.412, 93.443, 93.398, 93.34, 93.356, 93.306, 93.319,
                               93.318, 93.346, 93.124, 93.339, 93.303, 93.448, 93.414, 93.422, 93.353, 93.275,
                               93.323, 93.329, 93.367, 93.305, 93.285, 93.305, 93.404, 93.43, 93.36, 93.217,
                               93.251, 93.234, 93.194, 93.162, 93.171, 93.237, 93.289, 93.23, 93.134, 93.055,
                               93.032, 92.967, 92.935, 92.876, 92.745, 92.853, 92.859, 92.769, 92.691, 92.688,
                               92.676, 92.63, 92.605, 92.826, 92.712, 92.568, 92.524, 92.458, 92.36, 92.301,
                               92.259, 92.409, 92.232, 92.146, 92.184, 92.184, 91.993, 91.893, 92.307, 92.064,
                               91.791, 91.587, 91.645, 91.664, 91.648, 91.546, 91.726, 91.577, 91.343, 91.249,
                               91.239, 91.117, 91.022, 90.996, 91.138, 90.933, 90.702, 90.66, 90.54, 90.465,
                               90.517, 90.338, 90.111, 90.219, 90.068, 89.815, 89.565, 89.611, 89.5, 89.291,
                               89.15, 89.068, 88.93, 88.824, 88.701, 88.583, 88.496, 88.39, 88.292, 88.219,
                               88.143, 88.09, 87.83, 87.705, 87.365, 88.448, 88.123, 87.725, 87.571, 87.34,
                               86.888, 86.857, 86.619, 86.431, 86.218, 85.952, 86.123, 85.939, 85.872, 85.574,
                               85.286, 85.109, 85.013, 85.079, 84.689, 84.416, 84.667, 84.414, 84.092, 84.149,
                               83.535, 83.622, 83.388, 83.059, 82.744, 82.699, 82.514, 82.646, 82.536, 82.413,
                               81.928, 81.852, 81.66, 81.518, 81.317, 81.029, 80.744, 80.482, 80.46, 80.404,
                               80.153, 79.926, 79.631, 79.495, 79.332, 79.25, 78.981, 78.837, 78.814, 78.484,
                               78.173, 78.1, 77.886, 77.706, 77.484, 77.409, 77.19, 76.825, 76.513, 76.465,
                               76.25, 76.088, 75.809, 75.584, 76.659, 76.361, 75.991, 75.771, 75.614, 75.477,
                               75.261, 75.133, 74.758, 74.625, 74.461, 74.291, 73.922, 73.858, 73.679, 73.542,
                               73.126, 73.526, 73.269, 73.09, 72.909, 72.685, 72.499, 72.312, 72.263, 71.956]], dtype=np.float32)
expected_tvu = np.array([[11.156658, 8.843078, 10.660233, 5.653927, 10.981759, 12.767415, 17.553123, 18.761202, 8.843327, 6.5306535,
                          6.5284114, 9.226882, 12.346965, 6.8288465, 17.347519, 5.6800675, 8.459905, 14.890315, 9.262448, 15.234983,
                          10.3155155, 16.714645, 11.407037, 16.490915, 8.407591, 10.278806, 3.766759, 8.417813, 10.813256, 5.6486397,
                          10.488979, 7.3120522, 5.3521724, 7.0595174, 7.3197613, 9.260168, 9.044667, 8.452194, 9.264211, 11.014651,
                          5.6766124, 10.878855, 7.32476, 5.008749, 8.253746, 5.349691, 7.7904587, 10.522205, 14.259261, 3.7865636,
                          7.3242683, 6.8212276, 6.5584507, 7.8032355, 8.037464, 5.0158157, 6.8326907, 5.677563, 5.9854794, 5.0090284,
                          3.7877674, 3.789309, 5.004499, 3.2838476, 4.240415, 5.010705, 3.7889922, 3.789541, 5.354862, 5.6805425,
                          5.6832037, 4.2391887, 4.639559, 3.7894144, 3.284286, 3.790681, 3.7952573, 4.2414055, 4.2400613, 3.794604,
                          4.2420654, 3.794646, 5.013638, 3.7947094, 3.7954261, 3.7963324, 3.7967114, 3.291767, 5.019275, 5.016346,
                          3.7990706, 4.245647, 5.0208926, 5.0200005, 3.7994075, 3.2933156, 3.2929149, 2.693108, 6.5779624, 5.027246,
                          3.8035529, 4.2514606, 3.8030903, 5.373236, 3.8046255, 3.2971754, 3.298558, 3.2992308, 3.298958, 3.2986488,
                          4.255269, 6.848806, 5.0355935, 3.3015575, 3.8117676, 3.3015394, 3.8116834, 5.387926, 5.0385118, 2.697796,
                          2.697381, 2.6996632, 3.8118935, 3.303011, 2.6999595, 3.304137, 1.9174337, 3.3061697, 4.262055, 4.262501,
                          3.306823, 1.9180068, 0.52518284, 1.9180068, 0.52522147, 3.3081653, 3.3089268, 4.2676353, 3.3076756, 2.7043993,
                          3.308818, 2.70539, 1.9196104, 2.7050204, 3.310667, 6.0360546, 3.3110113, 5.402457, 3.8229368, 5.0514984,
                          2.7076359, 5.403257, 3.3123157, 5.723946, 5.0529394, 5.402961, 5.73086, 5.4034934, 5.406543, 6.8959074,
                          5.4066906, 5.0549893, 4.68245, 4.684141, 4.6853194, 4.6861386, 4.279218, 5.41163, 4.277161, 4.278657,
                          4.2789145, 4.2801995, 4.2803864, 4.280783, 4.281297, 4.28083, 6.051707, 4.2822313, 4.282021, 5.0655303,
                          5.065834, 5.0701985, 4.282325, 4.6858826, 5.0641203, 5.4097967, 7.905869, 5.4241514, 4.695808, 5.066691,
                          5.4173627, 5.068514, 6.349898, 6.061943, 5.7522097, 5.750801, 6.059567, 6.060095, 3.323075, 3.3233097,
                          5.0704746, 3.323797, 5.414261, 3.8358467, 1.9274946, 1.9289973, 1.928645, 3.3251686, 4.2876225, 4.693917,
                          2.7164683, 2.7165568, 3.8364305, 3.8351376, 3.322696, 3.323057, 3.324844, 3.837744, 4.2877855, 5.0676856,
                          3.834011, 3.8336563, 4.283912, 3.3204741, 3.8323417, 4.692945, 5.069674, 3.3217027, 1.9257419, 3.8299193,
                          3.829439, 3.828081, 5.059889, 3.3153028, 2.7079458, 3.3148866, 3.8258233, 3.313366, 3.822309, 3.311899,
                          2.7069268, 1.9205054, 3.8205087, 4.682424, 4.679502, 3.8197339, 3.8188124, 4.672984, 4.670467, 4.2630167,
                          4.2620316, 3.3068411, 3.3036284, 3.3020663, 2.6996484, 3.3027568, 4.661028, 7.83628, 5.7165513, 3.3005762,
                          2.6938207, 3.7991338, 4.2476015, 3.8007548, 4.247672, 4.2452703, 2.6928556, 1.9095186, 3.2874446, 4.2382684,
                          2.6856136, 4.235153, 4.232909, 3.786669, 3.2837014, 3.279954, 4.627672, 4.9965477, 5.6606402, 5.963922,
                          5.9656653, 3.2690527, 5.324479, 3.7702188, 4.2103124, 4.9728155, 5.933664, 3.2556837, 3.2536376, 4.1918178,
                          4.587252, 3.2456622, 4.5814934, 4.1806626, 3.2388716, 3.7353458, 4.17281, 4.5673285, 6.1777654, 6.4494467,
                          4.5608344, 4.924013, 5.5738015, 4.549296, 6.144665, 3.234182, 4.163862, 3.7169259, 7.4183235, 7.4083524,
                          4.134097, 7.614645, 7.3771434, 4.515567, 7.359729, 6.3645277, 6.8809185, 6.6236305, 6.870697, 5.186353,
                          4.4850364, 3.6601925, 5.4820757, 6.5897865, 6.048097, 6.811103, 3.1632693, 5.757429, 4.065905, 5.1422048,
                          7.6810966, 7.2459764, 3.6223848, 2.5609195, 3.6081352, 6.240656, 4.02691, 4.413839, 6.234384, 7.8372126,
                          6.9432654, 6.4612117, 5.936896, 3.5808513, 5.359349, 3.9898646, 3.0879738, 3.0828798, 8.700548, 3.0813615,
                          5.016331, 4.3392625, 3.5384464, 8.465185, 8.816117, 7.0502563, 8.437208, 8.961942, 5.5594983, 4.2992015,
                          3.9176335, 9.255588, 9.24263, 9.395043, 9.381329, 4.269092, 7.3777275, 3.4744334, 3.467243, 9.156129,
                          8.978302, 6.2249503, 9.277194, 9.577058, 6.0038834, 4.2395325, 5.177383, 7.7031693, 8.070334, 3.4432588,
                          10.579723, 8.044067, 6.843336, 2.425665, 10.522098, 10.509811, 5.380637, 10.339713, 10.326895, 4.800845,
                          9.107912, 6.1170073, 10.01541, 10.144725, 10.27157, 10.393028, 10.515049, 10.634896, 5.046112, 3.3604667]], dtype=np.float32)
expected_thu = np.array([[4.881826, 4.5039606, 4.774563, 4.28676, 4.829751, 5.2601914, 7.232052, 7.883808, 4.4902463, 4.3171697,
                          4.3165493, 4.5286927, 5.0981283, 4.327604, 6.9384966, 4.2829056, 4.4362884, 5.8319674, 4.5142555, 5.9409413,
                          4.6487374, 6.5375137, 4.829818, 6.4098444, 4.421147, 4.629565, 4.249827, 4.417898, 4.7013626, 4.2781525,
                          4.6449847, 4.3395557, 4.2704315, 4.3257055, 4.3377357, 4.480357, 4.457891, 4.40637, 4.4740705, 4.6906548,
                          4.275451, 4.6631203, 4.331588, 4.262049, 4.3821845, 4.2673674, 4.352043, 4.5939946, 5.3106894, 4.248529,
                          4.3240676, 4.3035088, 4.294262, 4.3446674, 4.3562884, 4.2598968, 4.301349, 4.2704678, 4.2767167, 4.2592235,
                          4.24801, 4.24797, 4.2587457, 4.2455897, 4.2507844, 4.2583947, 4.2477403, 4.2476974, 4.262645, 4.267747,
                          4.267572, 4.250285, 4.2535152, 4.2474318, 4.2453127, 4.2473483, 4.2473106, 4.2498655, 4.2497897, 4.2471805,
                          4.2496743, 4.2470994, 4.2561135, 4.247001, 4.246965, 4.2469287, 4.2468896, 4.245015, 4.2553997, 4.2552485,
                          4.24673, 4.248963, 4.254906, 4.254779, 4.2465806, 4.2448397, 4.244817, 4.2435985, 4.276656, 4.2541428,
                          4.24637, 4.2484136, 4.2462964, 4.257099, 4.246227, 4.24464, 4.244625, 4.244609, 4.2445903, 4.2445707,
                          4.247954, 4.277929, 4.252854, 4.2445025, 4.2459245, 4.2444687, 4.245865, 4.2554245, 4.2523274, 4.2426624,
                          4.242663, 4.2426634, 4.2427325, 4.2426934, 4.242665, 4.2426953, 4.2426467, 4.2426977, 4.2428, 4.242803,
                          4.2427006, 4.2426476, 4.2426405, 4.2426476, 4.2426405, 4.242705, 4.242706, 4.2428236, 4.2427073, 4.2426705,
                          4.242709, 4.2426715, 4.2426486, 4.2426724, 4.2427125, 4.2434487, 4.242714, 4.243168, 4.2427735, 4.24305,
                          4.2426744, 4.2431855, 4.242718, 4.24334, 4.2430677, 4.2432036, 4.2433567, 4.2432117, 4.243214, 4.2441688,
                          4.243222, 4.243086, 4.242969, 4.242971, 4.242974, 4.242974, 4.242873, 4.243238, 4.242874, 4.242874,
                          4.242875, 4.242875, 4.242876, 4.242876, 4.242876, 4.242876, 4.2435827, 4.242876, 4.242875, 4.2431,
                          4.2430983, 4.2431, 4.242873, 4.242974, 4.243094, 4.2432275, 4.2453136, 4.2432275, 4.242969, 4.243084,
                          4.243217, 4.2430797, 4.243715, 4.2435284, 4.2433534, 4.2433467, 4.2435083, 4.2435, 4.2427173, 4.242717,
                          4.24305, 4.2427154, 4.2431626, 4.2427707, 4.2426486, 4.2426486, 4.2426486, 4.2427106, 4.242833, 4.2429137,
                          4.2426705, 4.24267, 4.2427573, 4.2427554, 4.2427044, 4.2427034, 4.242703, 4.2427497, 4.2428083, 4.242962,
                          4.242744, 4.242742, 4.242797, 4.242696, 4.242737, 4.242853, 4.242927, 4.242692, 4.242646, 4.243317,
                          4.2433357, 4.243355, 4.244886, 4.243064, 4.2428336, 4.2430844, 4.2434535, 4.243109, 4.2434945, 4.2431335,
                          4.242866, 4.2426987, 4.2435884, 4.2448263, 4.2448807, 4.243659, 4.243684, 4.245047, 4.2451043, 4.2443914,
                          4.2444377, 4.2433014, 4.243315, 4.2433305, 4.242955, 4.2433667, 4.2456055, 4.266888, 4.2496247, 4.243432,
                          4.2429986, 4.2440996, 4.2449765, 4.244172, 4.2450905, 4.245142, 4.243048, 4.2427444, 4.2435913, 4.245334,
                          4.2430816, 4.245449, 4.2455077, 4.2445135, 4.243713, 4.2437305, 4.2470703, 4.2487884, 4.252986, 4.2556734,
                          4.255956, 4.2438607, 4.2514434, 4.244895, 4.2462196, 4.2497573, 4.2573504, 4.243995, 4.2440195, 4.2465253,
                          4.2483263, 4.2440877, 4.2485204, 4.246791, 4.2441607, 4.2453885, 4.2470055, 4.2490296, 4.26443, 4.26901,
                          4.249356, 4.251935, 4.2581773, 4.249663, 4.266405, 4.2444215, 4.247629, 4.245862, 4.294584, 4.2951307,
                          4.2478247, 4.3031507, 4.2969418, 4.2504125, 4.2981653, 4.274282, 4.286166, 4.28061, 4.2873282, 4.257404,
                          4.251026, 4.24641, 4.2619786, 4.283603, 4.2721634, 4.290778, 4.2448883, 4.267786, 4.248979, 4.2591567,
                          4.325464, 4.3093863, 4.2468824, 4.2437077, 4.2469325, 4.2816916, 4.2495084, 4.252592, 4.2828317, 4.343833,
                          4.3060412, 4.2909307, 4.277607, 4.247326, 4.266534, 4.2500706, 4.245334, 4.2453513, 4.415142, 4.2454267,
                          4.262552, 4.2539396, 4.2476892, 4.408244, 4.4393973, 4.325246, 4.4125166, 4.4606557, 4.276015, 4.2547398,
                          4.2510843, 4.5025125, 4.5043902, 4.5248427, 4.5268626, 4.255335, 4.3562884, 4.248341, 4.2483616, 4.5171323,
                          4.50004, 4.304208, 4.542009, 4.5852447, 4.2959824, 4.256096, 4.2728553, 4.390547, 4.422466, 4.2487583,
                          4.7656407, 4.426335, 4.34077, 4.2442045, 4.7778144, 4.7806134, 4.2820754, 4.7595253, 4.7622113, 4.2685504,
                          4.5705504, 4.311275, 4.7188044, 4.74752, 4.777088, 4.8075066, 4.8387723, 4.870882, 4.277027, 4.2494507]], dtype=np.float32)


def test_orientation_module():
    dset = load_dataset(RealFqpr())
    raw_attitude = dset.raw_att
    # expand_dims required to maintain the time dimension metadata when you select only one value
    multibeam = dset.raw_ping[0].isel(time=0).expand_dims('time')
    traveltime = multibeam.traveltime
    delay = multibeam.delay
    timestamps = multibeam.time

    installation_params_time = list(dset.xyzrph['tx_r'].keys())[0]
    tx_orientation = [np.array([1, 0, 0]),  # starting vector for the tx transducer (points forward)
                      dset.xyzrph['tx_r'][installation_params_time],  # roll mounting angle for tx
                      dset.xyzrph['tx_p'][installation_params_time],  # pitch mounting angle for tx
                      dset.xyzrph['tx_h'][installation_params_time],  # yaw mounting angle for tx
                      installation_params_time]  # time stamp for the installation parameters record
    rx_orientation = [np.array([0, 1, 0]),  # same but for the receiver
                      dset.xyzrph['rx_r'][installation_params_time],
                      dset.xyzrph['rx_p'][installation_params_time],
                      dset.xyzrph['rx_h'][installation_params_time],
                      installation_params_time]
    latency = 0  # no latency applied for this test

    calc_tx_vector, calc_rx_vector = build_orientation_vectors(raw_attitude, traveltime, delay, timestamps,
                                                               tx_orientation, rx_orientation, latency)

    try:
        assert np.array_equal(calc_tx_vector.values, expected_tx_vector)
    except AssertionError:
        print('Falling back to approx, should only be seen in TravisCI environment in my experience')
        # use approx here, I get ever so slightly different answers in the Travis CI environment
        assert calc_tx_vector.values == pytest.approx(expected_tx_vector, 0.000001)
    try:
        assert np.array_equal(calc_rx_vector.values, expected_rx_vector)
    except AssertionError:
        print('Falling back to approx, should only be seen in TravisCI environment in my experience')
        # use approx here, I get ever so slightly different answers in the Travis CI environment
        assert calc_rx_vector.values == pytest.approx(expected_rx_vector, 0.000001)


def test_beampointingvector_module():
    dset = load_dataset(RealFqpr())
    raw_attitude = dset.raw_att
    heading = raw_attitude.heading

    multibeam = dset.raw_ping[0].isel(time=0).expand_dims('time')
    beampointingangle = multibeam.beampointingangle
    tiltangle = multibeam.tiltangle
    ping_time_heading = heading.interp_like(beampointingangle)

    tx_vecs = xr.DataArray(data=expected_tx_vector, dims=['time', 'beam', 'xyz'], coords={'time': multibeam.time.values,
                                                                                          'beam': multibeam.beam.values,
                                                                                          'xyz': ['x', 'y', 'z']})
    rx_vecs = xr.DataArray(data=expected_rx_vector, dims=['time', 'beam', 'xyz'], coords={'time': multibeam.time.values,
                                                                                          'beam': multibeam.beam.values,
                                                                                          'xyz': ['x', 'y', 'z']})

    tx_reversed = False
    rx_reversed = False

    beam_azimuth, corrected_beam_angle = build_beam_pointing_vectors(ping_time_heading, beampointingangle, tiltangle, tx_vecs,
                                                                     rx_vecs, tx_reversed, rx_reversed)

    try:
        assert np.array_equal(beam_azimuth.values, expected_beam_azimuth)
    except AssertionError:
        print('Falling back to approx, should only be seen in TravisCI environment in my experience')
        # use approx here, I get ever so slightly different answers in the Travis CI environment
        assert beam_azimuth.values == pytest.approx(expected_beam_azimuth, 0.000001)
    try:
        assert np.array_equal(corrected_beam_angle.values, expected_corrected_beam_angles)
    except AssertionError:
        print('Falling back to approx, should only be seen in TravisCI environment in my experience')
        # use approx here, I get ever so slightly different answers in the Travis CI environment
        assert corrected_beam_angle.values == pytest.approx(expected_corrected_beam_angles, 0.000001)


def test_svcorrect_module():
    dset = load_dataset(RealFqpr())
    multibeam = dset.raw_ping[0].isel(time=0).expand_dims('time')
    cast = json.loads(multibeam.profile_1495599960)
    beam_azimuth = xr.DataArray(data=expected_beam_azimuth, dims=['time', 'beam'], coords={'time': multibeam.time.values,
                                                                                           'beam': multibeam.beam.values})
    beam_angle = xr.DataArray(data=expected_corrected_beam_angles, dims=['time', 'beam'], coords={'time': multibeam.time.values,
                                                                                                  'beam': multibeam.beam.values})
    traveltime = multibeam.traveltime
    surface_ss = multibeam.soundspeed

    installation_params_time = list(dset.xyzrph['tx_r'].keys())[0]
    waterline = float(dset.xyzrph['waterline'][installation_params_time])
    additional_offsets = np.array([[0],[0],[0]])

    alongtrack, acrosstrack, depth = run_ray_trace_v2(cast, beam_azimuth, beam_angle, traveltime, surface_ss, waterline, additional_offsets)
    assert np.array_equal(alongtrack, expected_alongtrack)
    assert np.array_equal(acrosstrack, expected_acrosstrack)
    assert np.array_equal(depth, expected_depth)


def test_georeference_module():
    dset = load_dataset(RealFqpr())
    multibeam = dset.raw_ping[0].isel(time=0).expand_dims('time')
    x = xr.DataArray(data=expected_alongtrack, dims=['time', 'beam'], coords={'time': multibeam.time.values,
                                                                              'beam': multibeam.beam.values})
    y = xr.DataArray(data=expected_acrosstrack, dims=['time', 'beam'], coords={'time': multibeam.time.values,
                                                                               'beam': multibeam.beam.values})
    z = xr.DataArray(data=expected_depth, dims=['time', 'beam'], coords={'time': multibeam.time.values,
                                                                         'beam': multibeam.beam.values})
    sv_corr = [x, y, z]

    raw_attitude = dset.raw_att
    heading = raw_attitude.heading.interp_like(z)
    heave = raw_attitude.heave.interp_like(z)

    raw_navigation = dset.raw_nav
    altitude = raw_navigation.altitude.interp_like(z)
    longitude = raw_navigation.longitude.interp_like(z)
    latitude = raw_navigation.altitude.interp_like(z)

    installation_params_time = list(dset.xyzrph['tx_r'].keys())[0]
    waterline = float(dset.xyzrph['waterline'][installation_params_time])
    vert_ref = 'waterline'

    input_datum = CRS.from_epsg(7911)
    output_datum = CRS.from_epsg(26910)

    z_offset = 1.0

    georef_x, georef_y, georef_z, corrected_heave, corrected_altitude = georef_by_worker(sv_corr, altitude, longitude, latitude, heading, heave,
                                                                                         waterline, vert_ref, input_datum, output_datum, z_offset)
    assert np.array_equal(georef_x, expected_georef_x)
    assert np.array_equal(georef_y, expected_georef_y)
    assert np.array_equal(georef_z, expected_georef_z)


def test_tpu():
    dset = load_dataset(RealFqpr())
    multibeam = dset.raw_ping[0].isel(time=0).expand_dims('time')
    qf = multibeam.qualityfactor
    tpu = build_tpu_parameters()

    surface_ss = multibeam.soundspeed
    beampointingangle = multibeam.beampointingangle
    corr_beam_angle = xr.DataArray(data=expected_corrected_beam_angles, dims=['time', 'beam'],
                                   coords={'time': multibeam.time.values, 'beam': multibeam.beam.values})
    x = xr.DataArray(data=expected_alongtrack, dims=['time', 'beam'], coords={'time': multibeam.time.values,
                                                                              'beam': multibeam.beam.values})
    z = xr.DataArray(data=expected_depth, dims=['time', 'beam'], coords={'time': multibeam.time.values,
                                                                         'beam': multibeam.beam.values})

    raw_attitude = dset.raw_att
    roll = raw_attitude['roll'].interp_like(beampointingangle)

    tvu, thu = calculate_tpu(roll, beampointingangle, corr_beam_angle, x, z, surface_ss, tpu, qf, vert_ref='waterline')
    assert np.array_equal(thu, expected_thu)
    assert np.array_equal(tvu, expected_tvu)
